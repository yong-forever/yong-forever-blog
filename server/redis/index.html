<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>《Redis》笔记 | yong-forever&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/yong-forever-blog/img/favicon.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/yong-forever-blog/assets/css/0.styles.33de1b1c.css" as="style"><link rel="preload" href="/yong-forever-blog/assets/js/app.61540ce8.js" as="script"><link rel="preload" href="/yong-forever-blog/assets/js/2.e7cba03d.js" as="script"><link rel="preload" href="/yong-forever-blog/assets/js/3.be5a514c.js" as="script"><link rel="preload" href="/yong-forever-blog/assets/js/42.9249fba3.js" as="script"><link rel="prefetch" href="/yong-forever-blog/assets/js/10.1b3f0f0e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/100.b79cf637.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/101.b39f267a.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/102.6f3e1545.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/103.6019464f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/104.b6e94524.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/105.15d73ac1.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/106.d4703deb.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/107.cf6d6727.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/108.d457175c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/109.f79fc245.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/11.b2681599.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/110.bc495869.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/111.e0154aa0.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/112.36a203d5.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/113.5f16e2fa.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/114.5f0911bd.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/115.1c8a7df2.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/116.f940b16e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/117.8815292b.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/118.c0aca63f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/119.dc00a694.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/12.5a54551f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/120.ce5b9fa2.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/121.37e9bf9f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/122.ca0dbdeb.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/123.ab615e6c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/124.dd68e5c2.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/125.31a8b242.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/126.6e6f6bf6.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/127.4206a9fe.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/128.e197d232.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/129.4fcfc708.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/13.a1964649.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/130.1621e03d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/131.c75e57d9.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/132.4cf6ca00.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/133.8aa8922d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/134.23fd63a4.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/135.fa929d53.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/136.c3dbcfc0.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/137.7381e405.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/138.680b5e55.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/139.0d339a30.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/14.67cdaae4.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/140.d1990d07.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/141.a85eb3e7.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/142.6669aea5.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/143.9406be88.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/144.cd1c833c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/145.e4908329.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/146.af9cd351.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/147.7cbd9705.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/148.2f8359ab.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/149.39c964b9.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/15.e28ff222.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/150.2edc5fe0.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/151.505ebc9f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/152.66029736.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/153.77b96b14.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/154.49d58388.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/155.dd3795e7.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/156.a045abae.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/157.e4b6f759.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/158.46af0f81.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/159.8665f021.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/16.828a21e4.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/160.63aa9240.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/161.0cbb13bd.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/162.c2da629e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/163.17037959.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/164.84d401a3.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/165.1d3b5e77.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/166.a5da2543.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/167.bd318b44.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/168.8747c65a.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/169.c5799fc4.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/17.6f7ac0e4.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/170.3a4cb9f7.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/171.08ca67c0.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/172.4d9efba6.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/173.312ef937.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/174.a035690a.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/175.8aa33f37.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/176.e200db06.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/177.637ed132.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/178.88194a7e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/179.44a8b73c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/18.b3168bb4.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/180.fccf148e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/181.4a4a5a6c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/182.a8b6cfbb.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/183.a9d32ac3.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/184.540c264c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/185.a5afec75.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/186.62333d59.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/187.e0a69f60.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/188.82703f70.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/189.d537cbe0.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/19.cd14c28c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/190.6cc54e4f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/191.daddfa5c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/192.9e30aa68.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/193.6cb9bc42.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/194.7810c6c2.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/195.e59dc288.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/196.fa8d38e5.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/197.5b359936.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/198.513074e8.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/199.5dff0fa8.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/20.dced456a.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/200.0dc6b27e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/201.d739af71.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/202.d4c4d1d1.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/203.7632f828.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/204.59426f06.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/205.2c7b8b1d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/206.fd91b74f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/207.ea9c2876.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/208.3ba49cc5.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/209.4c9e1548.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/21.a63af816.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/210.3d91b7f1.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/211.d1658ea8.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/212.21a5f6c9.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/213.198ba17c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/214.cc971a61.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/215.2551bbaa.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/216.15293d3d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/217.fb384925.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/218.dd881677.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/219.64ff2e6f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/22.bc7f8215.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/220.52503d55.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/221.a57103a5.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/222.3d646d24.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/223.80c881b8.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/224.37f24793.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/225.beeda46b.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/226.6571413d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/227.e6bce7c8.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/228.02b119df.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/229.064bce27.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/23.5b8bb994.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/230.49188d34.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/231.f6fcf5ea.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/232.ee08ecc8.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/233.fec10017.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/234.d59d9c7f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/235.a9fc3363.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/236.f5cb46e7.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/237.0bb02b7d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/238.a1078b85.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/239.5592d144.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/24.b45707a5.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/240.4ff1d7e4.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/241.50f3463d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/242.b39e58ba.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/243.f2ec6d2d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/244.22fe7586.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/245.872e98b6.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/246.17c651ae.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/247.b8c4330f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/248.4f84d2c6.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/249.fe390318.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/25.5532a89a.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/250.751ac8f7.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/251.818a742c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/252.e3fe1cd7.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/253.d00d13bc.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/26.dcb6a594.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/27.cd1fadca.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/28.8d75bd01.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/29.a93fab7e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/30.bdc09a5f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/31.3ab9e6b8.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/32.fd7e7bdf.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/33.e2ec2722.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/34.9eaf806f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/35.6c7f488c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/36.b2048811.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/37.5b1950af.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/38.f76a2c0a.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/39.35e99502.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/4.7f68c7bc.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/40.069b8344.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/41.8e23678d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/43.2f3a6204.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/44.85071374.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/45.950c1821.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/46.829fad5d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/47.77809037.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/48.c9133684.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/49.56da1a38.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/5.dced6ce5.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/50.a166e7bf.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/51.f174feb0.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/52.798ec56d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/53.723a0225.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/54.58255563.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/55.40c3bb39.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/56.969dd19d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/57.25213bb1.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/58.f2b47607.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/59.3e38129e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/6.232f8fcd.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/60.95d3735c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/61.7eaccbe1.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/62.ce1257e9.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/63.7276ebb1.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/64.91d550d5.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/65.44b10f7b.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/66.14afcb8d.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/67.9f1ac73e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/68.3c421cdc.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/69.ede88e61.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/7.a69db60e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/70.25aea6c8.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/71.d32a7e9c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/72.dc33542c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/73.c6ab9d11.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/74.a054e9d1.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/75.47c602bc.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/76.b1b12a6c.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/77.36e405c3.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/78.b2d8fa01.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/79.82a0042b.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/8.0afa700f.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/80.404f17d6.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/81.d6c7ee75.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/82.2d70cd0e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/83.4ae92aef.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/84.ca962558.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/85.37178f11.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/86.e0d6294e.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/87.6d2105a1.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/88.7042a96a.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/89.e3dd2c65.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/9.97d3521a.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/90.bc2a3190.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/91.baa2f2f6.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/92.82fe3ae1.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/93.47cfcf24.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/94.f305e568.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/95.13164362.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/96.0df202be.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/97.fe9d44de.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/98.4598be77.js"><link rel="prefetch" href="/yong-forever-blog/assets/js/99.effd5575.js">
    <link rel="stylesheet" href="/yong-forever-blog/assets/css/0.styles.33de1b1c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/yong-forever-blog/" class="home-link router-link-active"><img src="http://q.qlogo.cn/headimg_dl?dst_uin=1258225956&amp;spec=640&amp;img_type=jpg" alt="yong-forever's blog" class="logo"> <span class="site-name can-hide">yong-forever's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/yong-forever-blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/yong-forever-blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yong-forever-blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yong-forever-blog/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/yong-forever-blog/server/" class="link-title router-link-active">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yong-forever-blog/server/test/" class="nav-link">TEST</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yong-forever-blog/server/docker/" class="nav-link">《docker》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/javaweb/" class="nav-link">《JavaWeb》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/juc/" class="nav-link">《JUC》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/jvm/" class="nav-link">《JVM》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/mybatis/" class="nav-link">《Mybatis》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/mysql/" class="nav-link">《Mysql》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/redis/" aria-current="page" class="nav-link router-link-exact-active router-link-active">《Redis》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/springcloud/" class="nav-link">《SpringCloud》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/design/" class="nav-link">《设计模式》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/yong-forever-blog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/yong-forever-blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/yong-forever-blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/yong-forever-blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/yong-forever-blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/yong-forever-blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yong-forever-blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/yong-forever/yong-forever-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="http://q.qlogo.cn/headimg_dl?dst_uin=1258225956&amp;spec=640&amp;img_type=jpg"> <div class="blogger-info"><h3>Yiyong Zhan</h3> <span>如何对世界抱有持续的爱</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/yong-forever-blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/yong-forever-blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yong-forever-blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yong-forever-blog/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/yong-forever-blog/server/" class="link-title router-link-active">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yong-forever-blog/server/test/" class="nav-link">TEST</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/yong-forever-blog/server/docker/" class="nav-link">《docker》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/javaweb/" class="nav-link">《JavaWeb》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/juc/" class="nav-link">《JUC》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/jvm/" class="nav-link">《JVM》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/mybatis/" class="nav-link">《Mybatis》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/mysql/" class="nav-link">《Mysql》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/redis/" aria-current="page" class="nav-link router-link-exact-active router-link-active">《Redis》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/springcloud/" class="nav-link">《SpringCloud》</a></li><li class="dropdown-subitem"><a href="/yong-forever-blog/server/design/" class="nav-link">《设计模式》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/yong-forever-blog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/yong-forever-blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/yong-forever-blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/yong-forever-blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/yong-forever-blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/yong-forever-blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yong-forever-blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/yong-forever-blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/yong-forever/yong-forever-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>后端文章</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>学习笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yong-forever-blog/server/docker/" class="sidebar-link">《docker》笔记</a></li><li><a href="/yong-forever-blog/server/javaweb/" class="sidebar-link">《JavaWeb》笔记</a></li><li><a href="/yong-forever-blog/server/juc/" class="sidebar-link">《JUC》笔记</a></li><li><a href="/yong-forever-blog/server/jvm/" class="sidebar-link">《JVM》笔记</a></li><li><a href="/yong-forever-blog/server/mybatis/" class="sidebar-link">《Mybatis》笔记</a></li><li><a href="/yong-forever-blog/server/Mybatis-Plus/" class="sidebar-link">《Mybatis-Plus》笔记</a></li><li><a href="/yong-forever-blog/server/mysql/" class="sidebar-link">《Mysql》笔记</a></li><li><a href="/yong-forever-blog/server/redis/" aria-current="page" class="active sidebar-link">《Redis》笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#nosql概述" class="sidebar-link">Nosql概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#为什么要用nosql" class="sidebar-link">为什么要用Nosql</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#什么是nosql" class="sidebar-link">什么是NoSql</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#nosql的四大分类" class="sidebar-link">Nosql的四大分类</a></li></ul></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#redis入门" class="sidebar-link">Redis入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#linux安装" class="sidebar-link">Linux安装</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#测试性能" class="sidebar-link">测试性能</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#基础的知识" class="sidebar-link">基础的知识</a></li></ul></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#五大数据类型" class="sidebar-link">五大数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#redis-key" class="sidebar-link">Redis-Key</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#string-字符串" class="sidebar-link">String（字符串）</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#list-链表" class="sidebar-link">List（链表）</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#set-集合" class="sidebar-link">Set（集合）</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#hash-哈希" class="sidebar-link">Hash（哈希）</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#zset-有序集合" class="sidebar-link">Zset（有序集合）</a></li></ul></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#三种特殊数据类型" class="sidebar-link">三种特殊数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#geospatial-地理位置" class="sidebar-link">geospatial 地理位置</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#hyperloglog" class="sidebar-link">Hyperloglog</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#bigmaps" class="sidebar-link">Bigmaps</a></li></ul></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#事务" class="sidebar-link">事务</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#jedis" class="sidebar-link">Jedis</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#常用api" class="sidebar-link">常用API</a></li></ul></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#springboot-整合" class="sidebar-link">SpringBoot 整合</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#redis-conf详解" class="sidebar-link">Redis.conf详解</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#redis持久化" class="sidebar-link">Redis持久化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#rdb-redis-database" class="sidebar-link">RDB（Redis Database）</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#aof-append-only-file" class="sidebar-link">AOF（Append Only File）</a></li></ul></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#redis发布订阅" class="sidebar-link">Redis发布订阅</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#主从复制" class="sidebar-link">主从复制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#概念" class="sidebar-link">概念</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#环境配置" class="sidebar-link">环境配置</a></li></ul></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#一主二从" class="sidebar-link">一主二从</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#哨兵模式-自动选择主机" class="sidebar-link">哨兵模式（自动选择主机）</a></li></ul></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#redis缓存穿透和雪崩" class="sidebar-link">Redis缓存穿透和雪崩</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#缓存穿透" class="sidebar-link">缓存穿透</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#缓存击穿" class="sidebar-link">缓存击穿</a></li><li class="sidebar-sub-header"><a href="/yong-forever-blog/server/redis/#缓存雪崩" class="sidebar-link">缓存雪崩</a></li></ul></li></ul></li><li><a href="/yong-forever-blog/server/springcloud/" class="sidebar-link">《SpringCloud》笔记</a></li><li><a href="/yong-forever-blog/server/design/" class="sidebar-link">《设计模式》笔记</a></li></ul></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-70a2d273><div class="articleInfo" data-v-70a2d273><ul class="breadcrumbs" data-v-70a2d273><li data-v-70a2d273><a href="/yong-forever-blog/" title="首页" class="iconfont icon-home router-link-active" data-v-70a2d273></a></li> <li data-v-70a2d273><a href="/yong-forever-blog/categories/?category=%E5%90%8E%E7%AB%AF" title="分类" data-v-70a2d273>后端</a></li> <li data-v-70a2d273><a href="/yong-forever-blog/categories/?category=%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0" title="分类" data-v-70a2d273>学习笔记</a></li> <!----></ul> <div class="info" data-v-70a2d273><div title="作者" class="author iconfont icon-touxiang" data-v-70a2d273><a href="https://gitee.com/yong-forever" target="_blank" title="作者" class="beLink" data-v-70a2d273>yong</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-70a2d273><a href="javascript:;" data-v-70a2d273>2021-05-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          《Redis》笔记
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="redis"><a href="#redis" class="header-anchor">#</a> Redis</h1> <h2 id="nosql概述"><a href="#nosql概述" class="header-anchor">#</a> Nosql概述</h2> <h3 id="为什么要用nosql"><a href="#为什么要用nosql" class="header-anchor">#</a> 为什么要用Nosql</h3> <p>我们限制处理什么年代 2020年，大数据时代；</p> <blockquote><p>1、单机Mysql的时代</p></blockquote> <p>90年代，一个基本的网站访问量一般不会太大，单个数据库完全足够！</p> <ul><li>数据量如果太大：整个网站的瓶颈是什么？</li> <li>数据的索引（B+Tree），一个机器的内存页放不下</li> <li>访问量（读写混合），一个服务承受不了</li></ul> <blockquote><p>2、Memcached（缓存）+Mysql+垂直拆分（读写分离）</p></blockquote> <p>网站80%的情况都是在读数据，每次都要去查询数据库的话就会十分的麻烦，索引我们要减轻数据的压力，我们可以使用缓存</p> <blockquote><p>3、分库分表+水平拆分+Mysql集群</p></blockquote> <blockquote><p>4、如今最近的年代</p></blockquote> <p>Mysql等关系型数据库就不够用了！，数据量很多，变化很快！</p> <p>Mysql有的使用它储存一些比较大的文件，博客，图片！，数据表很大，效率就很低了！如果有一种数据库专门处理这种数据，mysql的压力就变得十分小，大数据的IO压力下，表几乎没法更改！</p> <blockquote><p>为什么要是有Nosql</p></blockquote> <p>用户的个人信息，社交网络，地理位置。用户自己产生的数据，用户日志等等爆发式增长。</p> <p>这时候我们就需要使用Nosql数据库的，nosql可以很好的处理以上的情况</p> <h3 id="什么是nosql"><a href="#什么是nosql" class="header-anchor">#</a> 什么是NoSql</h3> <blockquote><p>Nosql = Not Only SQL （不仅仅是SQL）</p></blockquote> <p>关系型数据库：表格，行，列（POI）</p> <p>泛指非关系型数据库的，随着web2.0互联网的诞生！传统的关系型数据库很难对付web2.0时代！尤其超大规模的高并发的社区！暴露出来很多难以克服的问题，Nosql在当今大数据环境下发展的十分迅速，Redis是发展最快的，而且是我们当下必须掌握的技术！</p> <p>很多的数据类型用户的个人信息，社交网络，地理位置。这些数据类型的储存不需要一个固定的格式！不需要多余的操作就可以横向扩展的！Map&lt;String,Object&gt; 键值对来控制</p> <blockquote><p>Nosql 特点</p></blockquote> <p>解耦！</p> <ol><li>方便扩展（数据之间没有关系，很好扩展!）</li> <li>大数据量高性能（Redis疫苗写8忘词，读取11万，Nosql的缓存记录级是一种细粒度缓存，性能会比较高！）</li> <li>数据类型是多样型的！（不需要实现设计数据库）</li> <li>传统的RDBMS和Nosql</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>传统的RDBMS
- 结构化组织
- SQL
- 数据和关系都存在单独的表中
- 数据定义语言
- 严格的一致性
- ..
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>Nosql
- 不仅仅是数据
- 没有固定的查询语言
- 键值对储存，列储存，文档储存，图形数据库（社交关系）
- 最终一致性
- CAP 定理和BASE 
- 高性能，高可用，高可扩
- ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>了解 3V+3高</p></blockquote> <p>大数据时代的3V：</p> <ol><li>海量Volume</li> <li>多样Variety</li> <li>实时Velocity</li></ol> <p>互联网需求的3高：</p> <ol><li>高并发</li> <li>高可拓</li> <li>高性能</li></ol> <h3 id="nosql的四大分类"><a href="#nosql的四大分类" class="header-anchor">#</a> Nosql的四大分类</h3> <p><strong>KV键值对：</strong></p> <ul><li>新浪：Redis</li> <li>美团：Redis+Tair</li> <li>阿里、百度：Redis+memecache</li></ul> <p><strong>文档型数据库（bson可是和json一样）</strong></p> <ul><li>MongoDB（一般必须要掌握）
<ul><li>MongoDB 是一个基于分布式文件储存的数据库，C++编写，主要用来处理大量的文档！</li> <li>MongoDB 是一个介于关系型数据库和非关系型数据的中间产品！最想关系型数据库的非关系数据库（功能丰富）</li></ul></li> <li>ConthDB</li></ul> <p><strong>列储存数据库</strong></p> <ul><li>HBase</li> <li>分布式文件系统</li></ul> <p><strong>图关系数据库</strong></p> <ul><li>他不是存图形，放的是关系，比如：朋友圈社交网络，广告推荐</li> <li>Neo4j，InfoGrid</li></ul> <blockquote><p>四者对比</p></blockquote> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200526173218601-1639133726112.png" alt="image-20200526173218601"></p> <h2 id="redis入门"><a href="#redis入门" class="header-anchor">#</a> Redis入门</h2> <h3 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h3> <blockquote><p>Redis 是什么？</p></blockquote> <p>Redis (Remote Dictionary Server),远程字典服务</p> <p>是一个开源的使用ANSI C语言编写、支持网络科技与内存亦可持久化的日志类型、key-value数据库、并提供多种语言的API，是诞下最热门的Nosql 技术之一！也被称之为结构化数据库</p> <blockquote><p>Redis 能干吗</p></blockquote> <ol><li>内存储存、持久化，内存中是断电即失、索引持久化很重要（rdb，aof）</li> <li>效率高，可以用于高速缓存</li> <li>发布订阅系统</li> <li>地图信息分析</li> <li>计时器、计数器（浏览量！）</li> <li>...</li></ol> <blockquote><p>特性</p></blockquote> <ol><li>多样的数据类型</li> <li>持久化</li> <li>集群</li> <li>事务</li> <li>...</li></ol> <p>http://www.redis.cn/ 中文官网</p> <h3 id="linux安装"><a href="#linux安装" class="header-anchor">#</a> Linux安装</h3> <ol><li><p>下载安装包<code>redis-6.0.3.tar.gz</code></p></li> <li><p>解压Redis安装包！tar -zxvf redis-6.0.3.tar.gz</p></li> <li><p>进入解压后的文件，可以看到配置文件</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200526180642391-1639133721984.png" alt="image-20200526180642391"></p></li> <li><p>基本环境安装</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token function">install</span> gcc-c++

<span class="token function">make</span>

redis6.0+需要的gcc版本为5.3及以上，所以升级gcc即可

//升级gcc到9以上
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> centos-release-scl
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils
<span class="token number">1</span>
<span class="token number">2</span>
<span class="token number">3</span>
还需要执行命令

//临时将此时的gcc版本改为9
scl <span class="token builtin class-name">enable</span> devtoolset-9 <span class="token function">bash</span>
//或永久改变
<span class="token builtin class-name">echo</span> <span class="token string">&quot;source /opt/rh/devtoolset-9/enable&quot;</span> <span class="token operator">&gt;&gt;</span>/etc/profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li> <li><p>redis的默认安装路径<code>usr/local/bin</code></p></li> <li><p>将redis配置文件，复制到我们的目录下</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200526182734952-1639133710088.png" alt="image-20200526182734952"></p></li> <li><p>redis默认不是后台启动的，修改配置文件redis.conf</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200526183029803-1639133707007.png" alt="image-20200526183029803"></p></li> <li><p>通过指定的配置文件运行</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200526185142127-1639133704475.png" alt="image-20200526185142127"></p></li> <li><p>使用Redis客户端进行连接</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200526185319462-1639133701339.png" alt="image-20200526185319462"></p></li> <li><p>查看redis的进程是否开启</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200526185453698-1639133698733.png" alt="image-20200526185453698"></p></li> <li><p>如何关闭redis服务</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200526185539450-1639133696055.png" alt="image-20200526185539450"></p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200526185618867-1639133694231.png" alt="image-20200526185618867"></p></li> <li><p>后面我们会使用单机多Redis启动集群测试！</p></li></ol> <h3 id="测试性能"><a href="#测试性能" class="header-anchor">#</a> 测试性能</h3> <p>redis-benchmark是一个压力测试工具！</p> <p>官方自带的性能测试工具！</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200527152939406-1639133690289.png" alt="image-20200527152939406"></p> <p>我们来简单测试下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#测试 100个并发连接 10000请求</span>
redis-benchmark <span class="token parameter variable">-h</span> localhost <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token parameter variable">-c</span> <span class="token number">100</span> <span class="token parameter variable">-n</span> <span class="token number">100000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200527153531451-1639133686436.png" alt="image-20200527153531451"></p> <p>如何查看这些分析</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200527154054228-1639133682746.png" alt="image-20200527154054228"></p> <h3 id="基础的知识"><a href="#基础的知识" class="header-anchor">#</a> 基础的知识</h3> <p>redis默认有16个数据库</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200527154815592-1639133678359.png" alt="image-20200527154815592"></p> <p>我们使用的是第0个</p> <p>可以使用select进行切换数据库</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200527154958554-1639133674892.png" alt="image-20200527154958554"></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">select</span> <span class="token number">3</span> <span class="token comment">#切换数据库</span>
DBSIZE <span class="token comment">#查看数据库大小</span>
keys * <span class="token comment">#查看数据库所有的key</span>
FLUSHDB <span class="token comment">#清除当前数据库</span>
FLUSHALL <span class="token comment">#清除所有数据库</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>为什么Redis是6379端口（粉丝效应）</p> <blockquote><p>Redis是单线程的！</p></blockquote> <p>Redis是很快额，官方表示，Redis是基于内存操作，CPU不是Redis性能瓶颈，Redis的瓶颈是根据机器的内存和网络代管，既然可以使用单线程来实现，就使用单线程了！</p> <p>Redis是C语言写的，官方提供的数据为10w+的QPS，网球不比Memecache差</p> <p><strong>Redis为什么单线程还这么快？</strong></p> <p><font color="red">误区：</font></p> <ol><li>高性能的服务器一定是多线程的</li> <li>多线程（CPU上下文会切换）一定比单线程效率高</li></ol> <p>CPU&gt;内存&gt;硬盘的速度</p> <p>核心：redis是将所有的数据全部放在内存中，所有说使用单线程去操作是最高的</p> <p>多线程上下文切换会消耗时间，对于内存系统来说，没有上下文切换效率就是最高的！，多次读写都是在一个CPU上的，在内存情况下单线程是最佳的方案！</p> <h2 id="五大数据类型"><a href="#五大数据类型" class="header-anchor">#</a> 五大数据类型</h2> <blockquote><p>官方文档</p></blockquote> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200527160345263-1639133669856.png" alt="image-20200527160345263"></p> <p>中文官网</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200527160554587-1639133664473.png" alt="image-20200527160554587"></p> <h3 id="redis-key"><a href="#redis-key" class="header-anchor">#</a> Redis-Key</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys * <span class="token comment">#查看所有的key</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> name yong <span class="token comment">#set key</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> EXISTS name <span class="token comment">#查看是否有这个key </span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> move name <span class="token comment">#移除 key name 1代表当前数据库</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> EXPIRE name <span class="token number">10</span> <span class="token comment">#10秒后 key name 会被删除 过期时间</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl name <span class="token comment">#查看当前key的剩余时间</span>

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">type</span> name <span class="token comment">#查看key name 的类型</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><a href="http://www.redis.cn/commands.html" target="_blank" rel="noopener noreferrer">官网命令<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="string-字符串"><a href="#string-字符串" class="header-anchor">#</a> String（字符串）</h3> <p>redis里存值会自动判断 可以加引号&quot;&quot;,也可以不加</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> key1 yong <span class="token comment">#设置值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name <span class="token comment">#获取值</span>
<span class="token string">&quot;yong&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> append name <span class="token string">&quot;aa&quot;</span> <span class="token comment">#追加字符串，如果key不存在，相当于set key</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> strlen name  <span class="token comment">#获取字符串长度</span>

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incr views <span class="token comment">#自增1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decr views <span class="token comment">#自减1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incrby views <span class="token number">10</span> <span class="token comment">#自增10 设置步长</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">11</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decrby views <span class="token number">10</span> <span class="token comment">#自减10</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> 


<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> key1 <span class="token string">&quot;hello,yong&quot;</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get key1 
<span class="token string">&quot;hello,yong&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getrange key1 <span class="token number">0</span> <span class="token number">4</span> <span class="token comment">#截取字符串 0-4</span>
<span class="token string">&quot;hello&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getrange key1 <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#截取所有字符串</span>
<span class="token string">&quot;hello,yong&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> key2 <span class="token string">&quot;abcdefg&quot;</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setrange key2 <span class="token number">1</span> xx <span class="token comment">#替换指定位置字符串</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">7</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get key2
<span class="token string">&quot;axxdefg&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> 

<span class="token comment">#setex(set with expire) #设置过期时间</span>
<span class="token comment">#setnx(set if not exist) #不存在再设置（再分布式锁中常常使用）</span>

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setex key3 <span class="token number">30</span> <span class="token string">&quot;hello&quot;</span> <span class="token comment">#设置有效期30s</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl key3 <span class="token comment">#查看剩余时间</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">26</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get key3 <span class="token comment">#可以取到值</span>
<span class="token string">&quot;hello&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setnx mykey <span class="token string">&quot;redis&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get key3 <span class="token comment">#key3 过期</span>
<span class="token punctuation">(</span>nil<span class="token punctuation">)</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setnx mykey <span class="token string">&quot;MongDB&quot;</span> 
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span> <span class="token comment">#返回值0 设置失败</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get mykey
<span class="token string">&quot;redis&quot;</span> <span class="token comment">#值任然是redis</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> 


<span class="token comment">#mset</span>
<span class="token comment">#mget</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mset k1 v1 k2 v2 k3 v3 <span class="token comment">#设置多个值</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;k2&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;k3&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mget k1 k2 k3 <span class="token comment">#获取多个值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> msetnx k1 v1 k4 v4  <span class="token comment">#k1存在，一旦失败，后面都会失败</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span> <span class="token comment">#设置失败</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys * <span class="token comment">#k4未设置</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;k2&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;k3&quot;</span>

<span class="token comment">#对象</span>
<span class="token builtin class-name">set</span> user:1<span class="token punctuation">{</span>name:zhangsan,age:3<span class="token punctuation">}</span> <span class="token comment">#设置user:1对象 值为json来保存</span>

<span class="token comment">#这里的key是一个巧妙地设计：user:{id}:{filed},如此设计再Redis是完全OK的</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mset user:1:name zhangsan user:1:age <span class="token number">2</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mget user:1:name user:1:age 
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;2&quot;</span>


getset <span class="token comment">#先get 再 set</span>

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getset db redis<span class="token comment">#先get 再 set</span>
<span class="token punctuation">(</span>nil<span class="token punctuation">)</span> <span class="token comment">#不存在值返回null</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get db
<span class="token string">&quot;redis&quot;</span> <span class="token comment">#之前设置的redis值</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getset db <span class="token string">&quot;MongDB&quot;</span>
<span class="token string">&quot;redis&quot;</span> <span class="token comment">#先获取redis值，后设置MongDB</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get db 
<span class="token string">&quot;MongDB&quot;</span> <span class="token comment">#获取MongDB值</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br></div></div><p>String类似的使用场景：value除了是我们的字符串还可以是数字</p> <ul><li>计数器</li> <li>统计多单位数量</li></ul> <h3 id="list-链表"><a href="#list-链表" class="header-anchor">#</a> List（链表）</h3> <p>基本的数据类型，列表</p> <p>在redis里面，我们可以把list做出栈，队列，阻塞队列</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LPUSH list one <span class="token comment">#将一个值或者多个值，插入列表初始位置</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LPUSH list two
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LPUSH list three
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LRANGE list <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#获取列表的所有值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;three&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LRANGE list <span class="token number">0</span> <span class="token number">1</span> <span class="token comment">#获取指定区间的值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;three&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> RPUSH list rrrrr <span class="token comment">#将一个值或者多个值，插入列表末尾位置</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LRANGE list <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;three&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;rrrrr&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LPOP list <span class="token comment">#移除初始位置的值</span>
<span class="token string">&quot;three&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> RPOP list <span class="token comment">#移除末尾位置的值</span>
<span class="token string">&quot;rrrrr&quot;</span>

LINDEX
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LRANGE list <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LINDEX list <span class="token number">0</span> <span class="token comment">#获取指定下标的值</span>
<span class="token string">&quot;two&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LLEN list <span class="token comment">#获取list长度</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> Lpush list one <span class="token comment">#再添加一个one值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LRANGE list <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span> 
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LREM list <span class="token number">1</span> two <span class="token comment">#移除一个two</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LRANGE list <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LREM list <span class="token number">2</span> one <span class="token comment">#移除2个one</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LRANGE list <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token punctuation">(</span>empty array<span class="token punctuation">)</span>

trim 修剪
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush mylist <span class="token string">&quot;h1&quot;</span> <span class="token string">&quot;h2&quot;</span> <span class="token string">&quot;h3&quot;</span> <span class="token string">&quot;h4&quot;</span> <span class="token comment">#存多个值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange mylist <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;h4&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;h3&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;h2&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;h1&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ltrim mylist <span class="token number">1</span> <span class="token number">2</span> <span class="token comment">#截取下标[1,2]区间的值 </span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange mylist <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#列表只剩下截取的部分</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;h3&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;h2&quot;</span>

rpoplpush <span class="token comment">#移除列表最后一个元素并添加到第一个位置</span>

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush mylist <span class="token string">&quot;h1&quot;</span> <span class="token string">&quot;h2&quot;</span> <span class="token string">&quot;h3&quot;</span> <span class="token string">&quot;h4&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange mylist <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;h4&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;h3&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;h2&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;h1&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpoplpush mylist myotherlist <span class="token comment">#移除列表最后一个元素</span>
<span class="token string">&quot;h1&quot;</span>                                         <span class="token comment">#添加到了目标list</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange mylist <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#查看原来的list</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;h4&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;h3&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;h2&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange myotherlist <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#查看目标list</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;h1&quot;</span>


<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> exists list <span class="token comment">#判断列表是否存在</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lset list <span class="token number">0</span> item <span class="token comment">#列表不存在不能set值</span>
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR no such key
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush list v1 <span class="token comment">#列表第一个位置存v1值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange list <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#查看列表</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lset list <span class="token number">0</span> item <span class="token comment">#修改列表第一个位置为item</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange list <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#查看列表，修改成功</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;item&quot;</span>


<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush mylist hello world <span class="token comment">#列表存两个值hello，world</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> linsert mylist before <span class="token string">&quot;world&quot;</span> <span class="token string">&quot;beF&quot;</span> <span class="token comment">#在 world 前插入bef这个值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange mylist <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#查看列表元素</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;beF&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;world&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;hello&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> linsert mylist after <span class="token string">&quot;world&quot;</span> <span class="token string">&quot;afT&quot;</span> <span class="token comment">#在 world 后插入afT这个值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange mylist <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#查看列表元素</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;beF&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;world&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;afT&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;hello&quot;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br></div></div><blockquote><p>小结</p></blockquote> <ul><li>实际上是一个链表,before Node after，left，right都可以插入值</li> <li>如果key不存在，创建新的链表</li> <li>如果key存在，新增内容</li> <li>如果移除所有值，空链表，也代表不存在！</li> <li>在两边插入值或者改动值，效率最高！中间元素相对较低~</li></ul> <p>消息排队！消息队列 lpush rpop ，栈lpush lpop</p> <h3 id="set-集合"><a href="#set-集合" class="header-anchor">#</a> Set（集合）</h3> <p>set中的值是不能重复的</p> <p>无序不重复集合。抽随机</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd myset <span class="token string">&quot;hello&quot;</span> <span class="token string">&quot;yong&quot;</span> <span class="token string">&quot;world&quot;</span> <span class="token comment">#set存值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers myset <span class="token comment">#查看所有值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;world&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;hello&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sismember myset hello <span class="token comment">#查看是否存在hello值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> scard myset <span class="token comment">#获取set集合元素个数</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srem myset hello <span class="token comment">#移除hello元素</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers myset <span class="token comment">#查看所有值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;world&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd myset v1 v2 v3 v4 v5 <span class="token comment">#多加几个值测试</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers myset <span class="token comment">#查看所有值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;world&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;v5&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;v4&quot;</span>
<span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srandmember myset <span class="token comment">#随机取值</span>
<span class="token string">&quot;v1&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srandmember myset
<span class="token string">&quot;yong&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srandmember myset
<span class="token string">&quot;world&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srandmember myset <span class="token number">2</span> <span class="token comment">#随机2个值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srandmember myset <span class="token number">2</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;v5&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> spop myset <span class="token comment">#随机删除元素</span>
<span class="token string">&quot;v1&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> spop  myset <span class="token comment">#随机删除元素</span>
<span class="token string">&quot;yong&quot;</span>

<span class="token comment">#将一个指定的值，移动到另外一个set集合中</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd myset hello world yong
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd myset2 set2
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smove myset myset2 yong <span class="token comment">#移动指定值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers myset
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;world&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;hello&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers myset2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;set2&quot;</span>


<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd set1 a b c d <span class="token comment">#set1元素 a b c d</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd set2 c d e f <span class="token comment">#set2元素 c d e f</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">sdiff</span> set1 set2 <span class="token comment">#set1跟set2的差集</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;a&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;b&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sinter set1 set2 <span class="token comment">#set1跟set2的交集</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;d&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;c&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sunion set1 set2 <span class="token comment">#set1跟set2的并集</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;d&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;c&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;b&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;a&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;e&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;f&quot;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><h3 id="hash-哈希"><a href="#hash-哈希" class="header-anchor">#</a> Hash（哈希）</h3> <p>Map集合，key-map！ 这个值是一个map集合</p> <p>本质和String没有太大得区别</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hset myhash f1 a  <span class="token comment">#set 一个具体可key value</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hmset myhash f1 a f2 b f3 c <span class="token comment">#set 多个kv</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hget myhash f1 <span class="token comment">#获取字段值</span>
<span class="token string">&quot;a&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hmget myhash f1 f2 f3 <span class="token comment">#获取多个字段值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;a&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;b&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;c&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hgetall myhash <span class="token comment">#获取全部得数据 </span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;f1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;a&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;f2&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;b&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;f3&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;c&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hdel myhash f1 <span class="token comment">#删除指定字段，对应value也没有了</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hgetall myhash
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;f2&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;b&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;f3&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;c&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hlen myhash <span class="token comment">#获取字段数量</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hexists myhash f1 <span class="token comment">#判断是否存在字段</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hvals myhash <span class="token comment">#获取全部值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;b&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;c&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hkeys myhash <span class="token comment">#获取全部key</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;f2&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;f3&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hset myhash f4 <span class="token number">0</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hincrby myhash f4 <span class="token number">1</span> <span class="token comment">#自增1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hincrby myhash f4 <span class="token parameter variable">-1</span> <span class="token comment">#hash没有decrby</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hsetnx myhash f5 hello <span class="token comment">#如果存在设置失败，没有设置f5</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="zset-有序集合"><a href="#zset-有序集合" class="header-anchor">#</a> Zset（有序集合）</h3> <p>在set的基础上，增加了一个值，set k1 v1 ------- zset k1 score1 v1</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd myset <span class="token number">1</span> one <span class="token comment">#添加一个值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd myset <span class="token number">2</span> two <span class="token number">3</span> three <span class="token comment">#添加多个值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange myset <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#获取所有值</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;one&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;two&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;three&quot;</span>

<span class="token comment">#排序</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd salary <span class="token number">2500</span> xiaohong 
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd salary <span class="token number">5000</span> zhangsan
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd salary <span class="token number">10000</span> yong
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrangebyscore salary <span class="token parameter variable">-inf</span> +inf<span class="token comment">#-inf +inf代表负无穷到正无穷区间</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xiaohong&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrangebyscore salary <span class="token parameter variable">-inf</span> +inf    <span class="token comment">#从小到大排序withscores#scores携带信息</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xiaohong&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;2500&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;5000&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;10000&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrevrange salary <span class="token number">0</span> <span class="token parameter variable">-1</span> withscores <span class="token comment">#从大到小排序</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;10000&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;5000&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;xiaoming&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;2500&quot;</span>

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrangebyscore salary <span class="token number">0</span> <span class="token punctuation">(</span><span class="token number">10000</span> <span class="token comment">#加括号代表 0&lt;=x&lt;10000 不加 0&lt;=x&lt;=10000 相当于不闭合区间 </span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrevrange salary <span class="token number">0</span> <span class="token parameter variable">-1</span> withscores <span class="token comment"># 递减排列</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;10000&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;5000&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;xiaohong&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;2500&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange salary <span class="token number">0</span> <span class="token parameter variable">-1</span> withscores <span class="token comment"># 递增排列</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xiaohong&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;2500&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;5000&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;10000&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrem salary xiaohong <span class="token comment">#移除元素</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange salary <span class="token number">0</span> <span class="token parameter variable">-1</span> withscores
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;5000&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;yong&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;10000&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zcard salary <span class="token comment">#获取集合元素个数</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>


<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd myset <span class="token number">1</span> hello <span class="token number">2</span> world <span class="token number">3</span> yong
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zcount myset <span class="token number">1</span> <span class="token number">2</span> <span class="token comment">#获取指定区间成员数量</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><h2 id="三种特殊数据类型"><a href="#三种特殊数据类型" class="header-anchor">#</a> 三种特殊数据类型</h2> <h3 id="geospatial-地理位置"><a href="#geospatial-地理位置" class="header-anchor">#</a> geospatial 地理位置</h3> <p>朋友的定位，附近的人，打车距离计算？</p> <p>Redis 的 Geo 在 Redis3.2 版本就推出了！</p> <p>这个共可以推算地理位置的信息，两地之间的距离，方圆几里的人！</p> <p>可以查询一些测试数据http://www.jsons.cn/lngcode/</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200528172318107-1639133659392.png" alt="image-20200528172318107"></p> <blockquote><p>geoadd</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># geoadd 添加地理位置</span>
<span class="token comment"># 武汉114.298572，30.584355 北京 116.405285，39.904989</span>
<span class="token comment"># 添加城市数据 （两极无法添加）一般通过java程序一次性导入数据</span>
<span class="token comment"># geoadd key 维度 经度 </span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">116.400</span> <span class="token number">39.90</span> beijing
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">114.29</span> <span class="token number">30.58</span> wuhan
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">121.47</span> <span class="token number">31.23</span> shanghai
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">114.08</span> <span class="token number">22.54</span> shenzhen
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">120.16</span> <span class="token number">30.24</span> hangzhou
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">108.96</span> <span class="token number">34.26</span> xian
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><p>geopos</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geopos china:city beijing <span class="token comment">#获取指定称视的经纬度</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;116.39999896287918091&quot;</span> <span class="token comment">#经度</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;39.90000009167092543&quot;</span>  <span class="token comment">#纬度</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geopos china:city wuhan
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;114.29000169038772583&quot;</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;30.58000021509926825&quot;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>geodist</p></blockquote> <p>两人之间的距离</p> <p>单位：</p> <ul><li><strong>m</strong> 米</li> <li><strong>km</strong> 千米</li> <li><strong>mi</strong> 英里</li> <li><strong>ft</strong> 英尺</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geodist china:city beijing wuhan <span class="token comment">#城市之间距离</span>
<span class="token string">&quot;1054104.6973&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geodist china:city beijing wuhan km <span class="token comment">#千米</span>
<span class="token string">&quot;1054.1047&quot;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>georadius</p></blockquote> <p>我附近的人？（获得手机定位）通过半径查询</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">500</span> km <span class="token comment">#集合中查询</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>            <span class="token comment">#110经度 30维度 半径 500千米</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;wuhan&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">1000</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;shenzhen&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;wuhan&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;hangzhou&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">1000</span> km withcoord count <span class="token number">2</span> <span class="token comment">#限制数量并携带信息</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;wuhan&quot;</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;114.29000169038772583&quot;</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;30.58000021509926825&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;108.96000176668167114&quot;</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;34.25999964418929977&quot;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><blockquote><p>georadiusbymember</p></blockquote> <p>根据成员元素半径查找</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadiusbymember china:city wuhan <span class="token number">800</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;wuhan&quot;</span>     <span class="token comment">#关于武汉周围800km城市</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;hangzhou&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;shanghai&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadiusbymember china:city wuhan <span class="token number">600</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;wuhan&quot;</span>     <span class="token comment">#关于武汉周围600km城市</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;hangzhou&quot;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>geohash  返回一个或多个位置元素geohash表示</p></blockquote> <p>返回11个字符的geohash字符串，精度降低(不常用)</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geohash china:city wuhan beijing
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;wt3mbwzmqj0&quot;</span>    <span class="token comment">#返回经纬度的字符串</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;wx4fbxxfke0&quot;</span>    <span class="token comment">#如果两个字符串越接近，距离越近</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>Geo 底层实现就是 Zset！ 我们可以通过Zset命令操作它</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange china:city <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#获取</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;shenzhen&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;wuhan&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;hangzhou&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;shanghai&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;beijing&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrem china:city beijing <span class="token comment">#删除</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange china:city <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#获取</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;shenzhen&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;wuhan&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;hangzhou&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;shanghai&quot;</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="hyperloglog"><a href="#hyperloglog" class="header-anchor">#</a> Hyperloglog</h3> <blockquote><p>简介</p></blockquote> <p>Redis 2.8.9 版本就更新了Hyperloglog 数据结构</p> <p>Redis Hyperloglog 技术统计的算法！</p> <p>优点：占用内存固定 ，2^64 不同的元素的计数 ，只需要12KB</p> <p><strong>网页的 UV （一个人访问一个网站多次还是算一个人）</strong></p> <p>传统的方式，set保存用户的id，重复会被覆盖，统计元素数量作为标准</p> <p>如果保存大量的用户id，就会比较麻烦！</p> <p>我们目的是为了计数，而不是保存用户id；</p> <p>从内存角度比较Hyperloglog首选（有0.81%错误率，忽略不计）</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd mykey a b c d e f g <span class="token comment">#存多个值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfcount mykey <span class="token comment">#获取数量</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">7</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd mykey2 e f g h i j k l <span class="token comment">#存多个值</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfcount mykey2 <span class="token comment">#获取数量</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">8</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfmerge mykey3 mykey mykey2 <span class="token comment">#去重整合mykey、mykey2</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfcount mykey3 <span class="token comment">#获取数量</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">12</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>如果允许容错，那么一定可以使用Hyperloglog，否则使用set</p> <h3 id="bigmaps"><a href="#bigmaps" class="header-anchor">#</a> Bigmaps</h3> <blockquote><p>位储存</p></blockquote> <p>Bitmap位图，数据结构！操作二进制位来进行记录，就只有0和1两个状态</p> <p>365天 = 365 bit 1字节 = 8 bit 46 个字节左右</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 记录一周的打卡</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">0</span> <span class="token number">1</span>  <span class="token comment">#0:周一 1:打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">1</span> <span class="token number">0</span>  <span class="token comment">#0:周二 0:没有打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">2</span> <span class="token number">0</span>  <span class="token comment">#0:周三 0:没有打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">3</span> <span class="token number">1</span>  <span class="token comment">#0:周四 1:打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">4</span> <span class="token number">1</span>  <span class="token comment">#0:周五 1:打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">5</span> <span class="token number">1</span>  <span class="token comment">#0:周六 1:打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">6</span> <span class="token number">1</span>  <span class="token comment">#0:周日 1:打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token comment"># 查看打卡</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getbit sign <span class="token number">2</span> <span class="token comment">#周三没有打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getbit sign <span class="token number">6</span> <span class="token comment">#周日打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token comment"># 统计打卡天数</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> bitcount sign <span class="token comment">#一周5天打卡</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="事务"><a href="#事务" class="header-anchor">#</a> 事务</h2> <p>Redis 事务本质：一组命令的集合</p> <p>在事务执行的过程中，会按照顺序执行！一次性、顺序性、排他性</p> <p><strong>Redis单条命令保存原子性，但是事务不保证原子性，没有隔离级别的概念</strong></p> <p>redis的事务：</p> <ul><li>**开启事务：**multi</li> <li>**命令入队：**执行命令语句</li> <li>**执行事务：**exec</li> <li>**放弃事务：**discard</li></ul> <blockquote><p>正常执行事务！</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k1 v1
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k2 v2
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get k2
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k3 v3
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token number">1</span><span class="token punctuation">)</span> OK
<span class="token number">2</span><span class="token punctuation">)</span> OK
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> OK

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><blockquote><p>放弃事务! discard 之前的命令语句不会执行</p></blockquote> <blockquote><p>编译型异常（命令出错、代码出错），事务中所有命令不会被执行</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getset k3 <span class="token comment">#错误语句</span>
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR wrong number of arguments <span class="token keyword">for</span> <span class="token string">'getset'</span> <span class="token builtin class-name">command</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k1 v1 <span class="token comment">#未被执行</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> EXECABORT Transaction discarded because of previous errors.
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get k1 <span class="token comment">#其他语句未被执行</span>
<span class="token punctuation">(</span>nil<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>运行时异常（1/0）如果队列中存在语法性错误、其他命令会正常执行、错误命令抛出异常</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi 
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k2 v2
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incr k2 <span class="token comment">#字符串不能自增</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k5 v5
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get k5
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exec</span> <span class="token comment">#其他语句正常执行</span>
<span class="token number">1</span><span class="token punctuation">)</span> OK
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR value is not an integer or out of range
<span class="token number">3</span><span class="token punctuation">)</span> OK
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;v5&quot;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><blockquote><p>监控！</p></blockquote> <p><strong>悲观锁：</strong></p> <ul><li>很悲观，认为什么时候都会出问题，无论做什么都加锁</li></ul> <p><strong>乐观锁：</strong></p> <ul><li>很乐观，认为什么时候都不会出问题，所以不会上锁，更新数据时去判断，在此期间是否有人修改过数据！</li> <li>获取version</li> <li>更新的时候比较version</li></ul> <p>Redis测试监视测试</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 正常执行成功</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> money <span class="token number">100</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> out <span class="token number">0</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">watch</span> money  <span class="token comment">#监视money对象</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi <span class="token comment">#数据期间没有发送变动</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decrby money <span class="token number">20</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incrby out <span class="token number">20</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">80</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">20</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">watch</span> money
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decrby money <span class="token number">10</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incrby out <span class="token number">10</span>
QUEUED

<span class="token comment">##########另外一个客户端执行数据操作</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get money
<span class="token string">&quot;80&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> money <span class="token number">200</span>
OK
<span class="token comment">##########</span>

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token punctuation">(</span>nil<span class="token punctuation">)</span> <span class="token comment">#修改失败</span>


<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> unwatch <span class="token comment">#之前的watch解除 旧version</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">watch</span> money <span class="token comment">#要重新关注 version</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decrby money <span class="token number">10</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incrby out <span class="token number">10</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exec</span> <span class="token comment">#如果监视对象没有改变，执行成功</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">190</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">30</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="jedis"><a href="#jedis" class="header-anchor">#</a> Jedis</h2> <p>我们要使用java来操作Redis</p> <blockquote><p>什么是Jedis 是Redis 官方推荐的java连接开放工具！使用java操作Redis中间件！</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>
<span class="token comment">#取消conf中 requirepass foot 和 #bing 127.0.0.1的注释</span>
<span class="token punctuation">[</span>root@iZwz9ffkm6t8sepux4rpxuZ bin<span class="token punctuation">]</span><span class="token comment"># redis-cli -p 6379</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> config get requirepass
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> NOAUTH Authentication required.
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> auth <span class="token string">&quot;redis-yong&quot;</span> <span class="token comment">#设置验证密码</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> config get requirepass <span class="token comment">#获取验证密码</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;requirepass&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;redis-yong&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>1、导入对应依赖</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/redis.clients/jedis --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2、编码测试:</p> <ul><li>连接数据库</li> <li>操作命令</li> <li>断开连接</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestPing</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//1、 new jedis 对象即可</span>
        <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">&quot;ip地址&quot;</span><span class="token punctuation">,</span><span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedis<span class="token punctuation">.</span><span class="token function">auth</span><span class="token punctuation">(</span><span class="token string">&quot;redis-yong&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//jedis 的所有命令就是我们之前学习的</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;清空数据&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">flushDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;判断某个键是否存在&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;新增&lt;'username','yong'&gt;的键值对&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;yong&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;新增&lt;'yong','yong'&gt;的键值对&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;yong&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;yong&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;系统所有键如下:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;删除键yong&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span><span class="token string">&quot;yong&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;判断yong键是否存在&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token string">&quot;yong&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查看username所储存的类型&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;随即返回一个key&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">randomKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;重命名key&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;取出改后的name&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;按索引查询&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;删除当前选择数控中的所有key&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">flushDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;返回当前数据库中的key的数目&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">dbSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;删除数据库中所有的key&quot;</span><span class="token operator">+</span>jedis<span class="token punctuation">.</span><span class="token function">flushAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="常用api"><a href="#常用api" class="header-anchor">#</a> 常用API</h3> <p>String</p> <p>List</p> <p>Set</p> <p>Hash</p> <p>Zset</p> <blockquote><p>事务</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestTX</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">&quot;47.112.216.42&quot;</span><span class="token punctuation">,</span><span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedis<span class="token punctuation">.</span><span class="token function">auth</span><span class="token punctuation">(</span><span class="token string">&quot;redis-yong&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//开启事务</span>
        <span class="token class-name">JSONObject</span> jsonObject<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jsonObject<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jsonObject<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;yong&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> multi <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">multi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> re <span class="token operator">=</span> jsonObject<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            multi<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">,</span>re<span class="token punctuation">)</span><span class="token punctuation">;</span>
            multi<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;user2&quot;</span><span class="token punctuation">,</span>re<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">;</span>
            multi<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行事务</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            multi<span class="token punctuation">.</span><span class="token function">discard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//放弃事务</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;user2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//关闭连接</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="springboot-整合"><a href="#springboot-整合" class="header-anchor">#</a> SpringBoot 整合</h2> <p>SpringBoot操作数据：spring-data jpa jdbc mongodb redis！</p> <p>SpringData也是和SpringBoot齐名的面古墓！</p> <p>说明：在SpringBoot2.X之后，原来使用的jedis被替换为了lettuce</p> <p>**jedis：**采用直连，多个线程操作的话，是不安全的，如果想要避免不安全，使用jedis pool连接池 BIO</p> <p>**lettuce：**采用netty，实例可以在多个线程中进行共享，不存在线程不安全的清空！也可以减少线程数据了，更像NIO模式</p> <p>源码分析：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token class-name">RedisOperations</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">RedisProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">LettuceConnectionConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">JedisConnectionConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisAutoConfiguration</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@Bean</span>
   <span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;redisTemplate&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">//我们可以自己定义一个redisTemplate来替换这个默认的</span>
   <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span>
         <span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">{</span>
       <span class="token comment">//默认RedisTemplate没有过多的设置，redis对象都是序列化</span>
       <span class="token comment">//两个泛型都是Obeject类型，我们使用需要强制转换&lt;String,Object&gt;</span>
      <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> template<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Bean</span>
   <span class="token annotation punctuation">@ConditionalOnMissingBean</span> <span class="token comment">//由于String 是 redis中最常用的类型，所有单独提出来了一个bean</span>
   <span class="token keyword">public</span> <span class="token class-name">StringRedisTemplate</span> <span class="token function">stringRedisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span>
         <span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">{</span>
      <span class="token class-name">StringRedisTemplate</span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> template<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><blockquote><p>整合测试</p></blockquote> <p>1、导入依赖</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
#选中nosql  spring-boot-starter-data-redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2、配置连接</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#配置redis</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 47.112.216.42
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>yong
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>3、测试</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">Redis02SpringbootApplicationTests</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RedisTemplate</span>  redisTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//redisTemplate.opsForValue();//操作字符串，类似String</span>
        <span class="token comment">//redisTemplate.opsForList();//操作List，类似List</span>
        <span class="token comment">//redisTemplate.opsForSet();//操作Set，类似Set</span>
        <span class="token comment">//redisTemplate.opsForHash();//操作Hash，类似Hash</span>
        <span class="token comment">//redisTemplate.opsForZSet();//操作ZSet，类似ZSet</span>
        <span class="token comment">//除了基本的操作，我们常用的方法都可以通过redisTemplate直接操作，比如增删改查</span>

        <span class="token comment">//获取连接对象</span>
        <span class="token comment">//RedisConnection connection = redisTemplate.getConnectionFactory().getConnection();</span>
        <span class="token comment">//connection.flushDb();</span>
        <span class="token comment">//connection.flushAll();</span>

        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;mykey&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;yong&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;mykey2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;勇&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;mykey&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;mykey2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200529190531289-1639133637856.png" alt="image-20200529190531289"></p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200529190229050-1639133624929.png" alt="image-20200529190229050"></p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200529190421674-1639133622871.png" alt="image-20200529190421674"></p> <p>直接传对象会报错，我们创建的对象需要实现序列化</p> <p>我们编写一个字节RedisTemplate</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">{</span>

    <span class="token comment">//编写我们的redis模板</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//为了开发方便，使用&lt;String,Object&gt;</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//序列化配置</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span> jackson2JsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectMapper</span> om<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">PropertyAccessor</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> <span class="token class-name">JsonAutoDetect<span class="token punctuation">.</span>Visibility</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">activateDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">LaissezFaireSubTypeValidator</span><span class="token punctuation">.</span>instance <span class="token punctuation">,</span> <span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_FINAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL)</span>
        jackson2JsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>om<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//String的序列化</span>
        <span class="token class-name">StringRedisSerializer</span> stringRedisSerializer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//key 采用String的序列化方式</span>
        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span>stringRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//hash 的key 采用String的序列化方式</span>
        template<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span>stringRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//value 采用String的序列化方式</span>
        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//hash 的value 采用String的序列化方式</span>
        template<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200529194448279-1639133618262.png" alt="image-20200529194448279"></p> <h2 id="redis-conf详解"><a href="#redis-conf详解" class="header-anchor">#</a> Redis.conf详解</h2> <p>启动的时候，就通过配置文件启动</p> <blockquote><p>单位</p></blockquote> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530175605406-1639133609719.png" alt="image-20200530175605406"></p> <ol><li>配置文件 unit单位对大小写不敏感！</li></ol> <blockquote><p>包含</p></blockquote> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530175725466-1639133604799.png" alt="image-20200530175725466"></p> <p>就像学习Spring一样，可以包含其他配置文件</p> <blockquote><p>网络</p></blockquote> <blockquote><p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530180029735-1639133602109.png" alt="image-20200530180029735"></p></blockquote> <blockquote><p>通用 GENERAL</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>daemonize <span class="token function">yes</span> <span class="token comment">#已守护进程方式允许，默认no 我们需要开启为yes</span>

pidfile /var/run/redis_6379.pid <span class="token comment">#如果以后台方式允许，我们就需要指定一个pid文件</span>

日志
<span class="token comment"># Specify the server verbosity level.</span>
<span class="token comment"># This can be one of:</span>
<span class="token comment"># debug (a lot of information, useful for development/testing)</span>
<span class="token comment"># verbose (many rarely useful info, but not a mess like the debug level)</span>
<span class="token comment"># notice (moderately verbose, what you want in production probably)</span>
<span class="token comment"># warning (only very important / critical messages are logged)</span>
loglevel notice
logfile <span class="token string">&quot;&quot;</span> <span class="token comment">#日志得文件位置名</span>
database <span class="token number">16</span> <span class="token comment">#数据库的数量 默认16</span>
always-show-logo <span class="token function">yes</span> <span class="token comment">#是否总是显示logo</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><blockquote><p>快照</p></blockquote> <p>持久化，在规定的时间内，执行了多少次擦欧总，则会持久化到文件.rdb .aof</p> <p>redis 是内存数据库，如果没有持久化，那么断电数据即失</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>save <span class="token number">900</span> <span class="token number">1</span> <span class="token comment">#如果900秒内，如果至少1个key进行了修改，执行持久化操作</span>
save <span class="token number">300</span> <span class="token number">10</span> <span class="token comment">#如果300秒内，如果至少10个key进行了修改，执行持久化操作</span>
save <span class="token number">60</span> <span class="token number">10000</span> <span class="token comment">#如果60秒内，如果至少10000个key进行了修改，执行持久化操作</span>

<span class="token comment">#我们之后学习持久化，会自己定义这个测试</span>

stop-writes-on-basave-error <span class="token function">yes</span> <span class="token comment">#持久化出错，是否需要继续工作</span>
rdbcompression <span class="token function">yes</span> <span class="token comment">#是否压缩 rdb 文件，需要一些消耗cpu资源</span>
rdbchecksum <span class="token function">yes</span> <span class="token comment">#保存rdb文件时，进行错误检查校验</span>
<span class="token function">dir</span> ./ <span class="token comment">#rdb文件保存目录！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>REPLICATION 复制，我们后面讲解主从复制的</p></blockquote> <blockquote><p>SECURITY 安全</p></blockquote> <p>可以设置redis的密码，默认没有密码</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>config get requirepass <span class="token comment">#获取redis密码</span>
config <span class="token builtin class-name">set</span> requirepass <span class="token string">&quot;密码&quot;</span> <span class="token comment">#设置redis密码</span>
auth <span class="token string">&quot;密码&quot;</span> <span class="token comment">#验证后可以继续操作</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>Clients 限制</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>maxclients <span class="token number">10000</span> <span class="token comment">#设置连接上redis的最大客户端数量</span>
maxmemory <span class="token operator">&lt;</span>bytes<span class="token operator">&gt;</span> <span class="token comment">#redis 默认最大内存容量 默认字节单位</span>

maxmemory-policy noeviction <span class="token comment">#内存到达上限之后的处理策略 </span>
<span class="token number">1</span>.volatile-lru:只对设置了过期时间的key进行LRU（默认）
<span class="token number">2</span>.allkeys-lru:删除lru算法的key
<span class="token number">3</span>.volatile-random:随机删除即将过期的key
<span class="token number">4</span>.allkeys-random:随机删除
<span class="token number">5</span>.volatile-ttl:删除即将过期的
<span class="token number">6</span>.noeviction:永不过期，返回错误

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>APPEND ONLY 模式 aof配置</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>appendonly no <span class="token comment">#默认不开启aof模式，默认使用rdb持久化，大部分情况下rdb够用</span>
appendfilename <span class="token string">&quot;appendonly.aof&quot;</span> <span class="token comment">#持久化文件的名字</span>

<span class="token comment"># appendfsync always #每次修改都会 同步sync，消耗性能</span>
appendfsync everysec <span class="token comment">#默认没有执行一次 sync 可能会丢失这1s的数据！</span>
<span class="token comment"># appendfsync no #不执行同步，这个时候操作系统字节同步数据，速度最快</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="redis持久化"><a href="#redis持久化" class="header-anchor">#</a> Redis持久化</h2> <p>Redis是内存数据库，如果不将内存中的数据库状态保存到磁盘，那么一旦服务器进程退出，服务器中的数据库装也会消失，所以Redis提供了持久化功能！</p> <h3 id="rdb-redis-database"><a href="#rdb-redis-database" class="header-anchor">#</a> RDB（Redis Database）</h3> <blockquote><p>什么是RDB</p></blockquote> <p>在主从复制中，rdb就是备用，从机上面</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530185823433-1639133556140.png" alt="image-20200530185823433"></p> <p>在指定的时间间隔内将内存中的数据集快照写入磁盘，也就是行话讲的Snapshot快照，他恢复时将快照文件直接读到内存里。</p> <p>Redis会单独创建(fork)一个子进程来进行持久化，会先将数据写入到一个临时文件中，待持久化过程都结束了，再用这个临时文件替换上次持久化好的文件。整个过程中，主进程是不进行任何IO操作的。这就确保了极高的性能。如果需要进行大规模数据的回复，且对于数据恢复的完整性不是非常敏感，那莪RDB方式要比AOF方式更加高效。RDB的缺点是最后一次持久化后数据可能丢失。</p> <p>==rdb保存的文件是 dumo.rdb，有时候会进行备份==</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530184140533-1639133533996.png" alt="image-20200530184140533"></p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530184252163-1639133532239.png" alt="image-20200530184252163"></p> <p>60s内修改5个key，触发rdb操作</p> <blockquote><p>触发机制</p></blockquote> <ol><li>save的规则满足的清空下，会触发rdb规则</li> <li>执行了flush ，也会触发我们的rdb规则</li> <li>退出redis，也会产生rdb文件</li></ol> <p>备份就会自动生成一个dump.rdb</p> <blockquote><p>如何恢复rdb文件!</p></blockquote> <ol><li>只需要将rdb文件放在我们redis启动目录就可以，redis启动时会自动检测dump.rdb并恢复其中数据</li> <li>查看需要存在的位置</li> <li><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530185437083-1639133526732.png" alt="image-20200530185437083"></li></ol> <ul><li>优点
<ul><li>适合大规模的数据恢复！</li> <li>如果你对数据完整性要求不高！</li></ul></li> <li>缺点
<ul><li>需要一定的时间间隔！如果意外宕机，最后一次修改数据就没有了</li> <li>fork进程的适合，会占用一定的内存空间</li></ul></li></ul> <h3 id="aof-append-only-file"><a href="#aof-append-only-file" class="header-anchor">#</a> AOF（Append Only File）</h3> <p>将我们的所有目录都记录下来，恢复的时候把这个文件全部在执行一遍！</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530191932406-1639133522982.png" alt="image-20200530191932406"></p> <p>以日志的形式来记录每个写操作，将Redis执行过的所有指令记录下来（读操作不记录），只许追加文件不可以改写文件，redis启动之初会读取该文件重新构建数据，换言之，redis重启的话就根据日志文件的内容将写指令从签到后执行一次完成数据的恢复工作</p> <p>==AOF保存的时appendonly.aof文件==</p> <blockquote><p>append</p></blockquote> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530192319034-1639133520357.png" alt="image-20200530192319034"></p> <p>默认不开启，我们手动配置,只需要改为yes</p> <p>重启shutdown就可以生效了</p> <p>aof文件(记录了我们所有写操作) 有问题启动会失败</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200530192917135-1639133517724.png" alt="image-20200530192917135"></p> <p>redis 给我们提供这样的工具<code>redis-check-aof --fix</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>redis-check-aof <span class="token parameter variable">--fix</span> appendonly.aof
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>文件正常，重启就直接恢复了！</p> <blockquote></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>appendonly no <span class="token comment">#默认不开启aof模式，默认使用rdb持久化，大部分情况下rdb够用</span>
appendfilename <span class="token string">&quot;appendonly.aof&quot;</span> <span class="token comment">#持久化文件的名字</span>

<span class="token comment"># appendfsync always #每次修改都会 同步sync，消耗性能</span>
appendfsync everysec <span class="token comment">#默认没有执行一次 sync 可能会丢失这1s的数据！</span>
<span class="token comment"># appendfsync no #不执行同步，这个时候操作系统字节同步数据，速度最快</span>

重写规则说明
auto-aof-rewrite-percentage <span class="token number">100</span>
auto-aof-rewrite-min-size 64mb 
<span class="token comment">#如果aof文件大于64m，会新建一个新fork进程将我们的文件进行重写！</span>
<span class="token comment">#aof默认就是文件的无限追加，文件会越来越大</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>优点
<ul><li>每一次修改都同步，让文件的完整性更加好！</li> <li>每秒同步一次，可能会丢失一秒的数据</li> <li>从不同步，效率最高！</li></ul></li> <li>缺点
<ul><li>相对于数据文件来说，aof远远大于rdb，修复的速度也比rdb慢</li> <li>aof允许效率也比rdb慢，所以edis默认配置时rdb</li></ul></li></ul> <p><strong>扩展:</strong></p> <ol><li><p>RDB持久化方式能够在指定的时间间隔内对你的数据进行快照存储</p></li> <li><p>AOF 持久化方式记录每次对服务器写的操作,当服务器重启的时候会重新执行这些命令来恢复原始的数据, AOF命令以Redis协议追加保存每次写的操作到文件末尾,Redis还能对AOF文件进行后台重写,使得AOF文件的体积不至于过大。</p></li> <li><p>只做缓存,如果你只希望你的数据在服务器运行的时候存在,你也可以不使用任何持久化</p></li> <li><p>同时开启两种持久化方式</p> <ul><li>在这种情况下,当redis重启的时候会优先载入AOF文件来恢复原始的数据,因为在通常情况下AOF文件保存的数据集要比RDB文件保存的数据集要完整。</li> <li>RDB的数据不实时,同时使用两者时服务器重启也只会找AOF文件,那要不要只使用AOF呢?作者建议不要,因为RDB更适合用于备份数据库( AOF在不断变化不好备份) , 快速重启,而且不会有AOF可能潜在的Bug ,留着作为一个万一的手段。</li></ul></li> <li><p>性能建议</p> <ul><li>因为RDB文件只用作后备用途,建议只在Slave.上持久化RDB文件,而且只要15分钟备份-次就够了,只保留save 900 1这条
规则。</li> <li>如果Enable AOF ,好处是在最恶劣情况下也只会丢失不超过两秒数据,启动脚本较简单只load自己的AOF文件就可以了,代价一是带来了持续的I0 ,二是AOF rewrite的最后将rewrite过程中产生的新数据写到新文件造成的阻塞几乎是不可避免的。只要硬盘许可,应该尽量减少AOF rewrite的频率, AOF重写的基础大小默认值64M太小了,可以设到5G以上,默认超过原大小100%大小重写可以改到适当的数值。</li> <li>如果不Enable AOF，仅靠Master-Slave Rellcation实现高可用性也可以，能省掉一大笔IO，也减少了rewrite时带来的系统波动。代价时如果Master/Slave同时倒掉，会丢失十几分钟的数据，启动脚本页脚两个Master/SLAVE中的RDB文件，载入较新的那个，微博就是这种架构</li></ul></li></ol> <h2 id="redis发布订阅"><a href="#redis发布订阅" class="header-anchor">#</a> Redis发布订阅</h2> <p>Redis 发布订阅（pub/sub）是一种消息通信模式：发送者pub发送消息，订阅者sub接收消息</p> <p>Redis 客户端可以订阅任意数量的频道</p> <p>消息发送者---&gt;频道---&gt;接收者</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200601124741888-1639133512646.png" alt="image-20200601124741888"></p> <p>关系</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200601125044757-1639133509179.png" alt="image-20200601125044757"></p> <p>下表列出了 redis 发布订阅常用命令：</p> <table><thead><tr><th style="text-align:left;">序号</th> <th style="text-align:left;">命令及描述</th></tr></thead> <tbody><tr><td style="text-align:left;">1</td> <td style="text-align:left;">[PSUBSCRIBE pattern <a href="https://www.runoob.com/redis/pub-sub-psubscribe.html" target="_blank" rel="noopener noreferrer">pattern ...]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 订阅一个或多个符合给定模式的频道。</td></tr> <tr><td style="text-align:left;">2</td> <td style="text-align:left;">[PUBSUB subcommand <a href="https://www.runoob.com/redis/pub-sub-pubsub.html" target="_blank" rel="noopener noreferrer">argument [argument ...]]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 查看订阅与发布系统状态。</td></tr> <tr><td style="text-align:left;">3</td> <td style="text-align:left;"><a href="https://www.runoob.com/redis/pub-sub-publish.html" target="_blank" rel="noopener noreferrer">PUBLISH channel message<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 将信息发送到指定的频道。</td></tr> <tr><td style="text-align:left;">4</td> <td style="text-align:left;">[PUNSUBSCRIBE <a href="https://www.runoob.com/redis/pub-sub-punsubscribe.html" target="_blank" rel="noopener noreferrer">pattern [pattern ...]]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 退订所有给定模式的频道。</td></tr> <tr><td style="text-align:left;">5</td> <td style="text-align:left;">[SUBSCRIBE channel <a href="https://www.runoob.com/redis/pub-sub-subscribe.html" target="_blank" rel="noopener noreferrer">channel ...]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 订阅给定的一个或多个频道的信息。</td></tr> <tr><td style="text-align:left;">6</td> <td style="text-align:left;">[UNSUBSCRIBE <a href="https://www.runoob.com/redis/pub-sub-unsubscribe.html" target="_blank" rel="noopener noreferrer">channel [channel ...]]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 指退订给定的频道。</td></tr></tbody></table> <p>测试</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> subscribe yongyong <span class="token comment">#订阅频道</span>
Reading messages<span class="token punctuation">..</span>. <span class="token punctuation">(</span>press Ctrl-C to quit<span class="token punctuation">)</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;subscribe&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;yongyong&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;message&quot;</span> <span class="token comment">#信息</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;yongyong&quot;</span> <span class="token comment">#来自那个频道</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;hello,yong&quot;</span> <span class="token comment">#具体消息</span>

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> publish yongyong <span class="token string">&quot;hello,yong&quot;</span> <span class="token comment">#频道发布信息</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> 


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><blockquote><p>原理</p></blockquote> <p>Redis是使用C实现的,通过分析Redis源码里的pubsub.c.文件,了解发布和订阅机制的底层实现,籍此加深对Redis的理解。</p> <p>Redis通过PUBLISH、SUBSCRIBE 和PSUBSCRIBE等命令实现发布和订阅功能。</p> <p>通过SUBSCRIBE命令订阅某频道后, redis-server里维护了-一个字典，字典的键就是一个个channel（频道） , 而字典的值则是-个链表,链表中保存了所有订阅这个channel的客户端。SUBSCRIBE 命令的关键,就是将客户端添加到给定channel的订阅链表中。</p> <p>通过PUBLISH命令向订阅者发送消息, redis-server 会使用给定的频道作为键,在它所维护的channel字典中查找记录了订阅这个频道的所有客户端的链表,遍历这个链表,将消息发布给所有订阅者。</p> <p>Pub/Sub从字面上理解就是发布( Publish )与订阅( Subscribe) , 在Redis中,你可以设定对某一-个key值进行消息发布及消息订阅，当一个key值上进行了消息发布后,所有订阅它的客户端都会收到相应的消息。这一功能最明显的用法就是用作实时消息系统,比如普通的即时聊天,群聊等功能。</p> <h2 id="主从复制"><a href="#主从复制" class="header-anchor">#</a> 主从复制</h2> <h3 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h3> <p>主从复制,是指将一台Redis服务器的数据 ,复制到其他的Redis服务器。前者称为主节点(master/leader) ,后者称为从节点(slave/follower) ;数据的复制是单向的,只能由主节点到从节点。Master以写为主 , Slave以读为主。</p> <p>默认情况下,每台Redis服务器都是主节点;且一个主节点可以有多个从节点(或没有从节点) ,但-个从节点只能有一个主节点。主从复制的作用主要包括:</p> <p>1、数据冗余:主从复制实现了数据的热备份,是持久化之外的一种数据冗余方式。</p> <p>2、故障恢复:当主节点出现问题时,可以由从节点提供服务,实现快速的故障恢复;实际上是一种服务的冗余。</p> <p>3、负载均衡:在主从复制的基础上,配合读写分离,可以由主节点提供写服务,由从节点提供读服务(即写Redis数据时应用连接主节点,读Redis数据时应用连接从节点) , 分担服务器负载;尤其是在写少读多的场景下,通过多个从节点分担读负载,可以大大提高Redis服务器的并发量。</p> <p>4、高可用（集群）基石:除了上述作用以外,主从复制还是哨兵和集群能够实施的基础,因此</p> <p>说主从复制是Redis高可用的基础。一般来说,要将Redis运用于工程项目中,只使用一台Redis是万万不能的,原因如下:</p> <p>1、从结构上,单个Redis服务器会发生单点故障,并且一 台服务器需要处理所有的请求负载,压力较大;</p> <p>2、从容量上,单个Redis服务器内存容量有限,就算一台Redis服务器内存容 量为256G ,也不能将所有内存用作Redis存储内存，一般来说，单台Redis最大使用内存不应该超过20G</p> <p>主从复制，读写分离！80%都是在进行读操作，减缓服务器的压力！架构中经常使用</p> <h3 id="环境配置"><a href="#环境配置" class="header-anchor">#</a> 环境配置</h3> <p>只配置从库，不配置主库！</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> info replication <span class="token comment"># 查看当前库的信息</span>
<span class="token comment"># Replication</span>
role:master <span class="token comment">#角色 master</span>
connected_slaves:0 <span class="token comment"># 没有从机</span>
master_replid:a0b366ba19bb17327af9edfcb70aeca780465b6c
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:0
master_repl_meaningful_offset:0
second_repl_offset:-1
repl_backlog_active:0
repl_backlog_size:1048576
repl_backlog_first_byte_offset:0
repl_backlog_histlen:0

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>复制配置文件，修改配置</p> <ol><li>端口</li> <li>pid名字</li> <li>log文件名字</li> <li>dump.rdb名字</li> <li>启动测试（一主一从）</li></ol> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200601132744113-1639133505393.png" alt="image-20200601132744113"></p> <h2 id="一主二从"><a href="#一主二从" class="header-anchor">#</a> 一主二从</h2> <p>默认情况下，每台Redis服务器都是主节点；我们一般情况下只用配置从机就好了</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>主机（6379） 从机（6380）（6381）

<span class="token number">127.0</span>.0.1:638<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> slaveof <span class="token number">127.0</span>.0.1 <span class="token number">6379</span> <span class="token comment">#认老大 从机配置主机</span>
OK
<span class="token number">127.0</span>.0.1:638<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> info replication <span class="token comment">#打印信息</span>
<span class="token comment"># Replication</span>
role:slave <span class="token comment">#角色从i</span>
master_host:127.0.0.1 <span class="token comment">#主机地址</span>
master_port:6379 <span class="token comment">#主机端口</span>
master_link_status:up
master_last_io_seconds_ago:1
master_sync_in_progress:0
slave_repl_offset:14
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:01ad28bd57429084225622ba289c0fad5c0c897e
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:14
master_repl_meaningful_offset:0
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:14


<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> info replication <span class="token comment">#打印信息</span>
<span class="token comment"># Replication</span>
role:master <span class="token comment">#角色 主机</span>
connected_slaves:1 <span class="token comment">#从机一个</span>
slave0:ip<span class="token operator">=</span><span class="token number">127.0</span>.0.1,port<span class="token operator">=</span><span class="token number">6380</span>,state<span class="token operator">=</span>online,offset<span class="token operator">=</span><span class="token number">28</span>,lag<span class="token operator">=</span><span class="token number">0</span>
master_replid:01ad28bd57429084225622ba289c0fad5c0c897e
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:28
master_repl_meaningful_offset:0
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:28

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>真实的主从配置应该在配置文件中配置，这样的话是永久的，命令是暂时的</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>配置文件 开启
<span class="token comment"># replicaof &lt;主机ip&gt; &lt;主机端口&gt;</span>
<span class="token comment"># masterauth 主机认证密码</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>细节</p></blockquote> <p>主机负责写，从机负责读！主机中的所有信息和数据都会被从机储存</p> <p>==从机是不能写数据的==</p> <p>测试：主机断开连接，从机依旧连接主机，但是没有写操作，如果主机重连，从机依旧可以获取主机写的新信息</p> <p>如果是使用命令行配置的主从关系，从机断开在连接，会失去之前的主从关系，需要再次命令行配置主从，数据会立马从主机中获取到</p> <blockquote><p>复制原理</p></blockquote> <p>Slave 启动成功连接到master后会发送一个sync同步命令</p> <p>Master 接到命令，启动后台的存盘进程，同时手机所有接收到的用于修改数据集的命令，在后台进程执行完毕之后，==master将传送整个数据文件到slave，并完成一次完全同步。==</p> <p>全量复制：而slave服务在接收到数据库文件数据后，将其存盘并加载到内存中</p> <p>增量复制：Master 继续将新的所有收集到的修改命令一次传给slave，完成同步</p> <p>但是只要是重新连接master，一尺完全同步（全量复制）将被自动执行</p> <blockquote><p>层层主从</p></blockquote> <p>除了首尾，每个节点都是上个节点的从机，下个节点的主机</p> <blockquote><p>如果主机没了，这时候能不能选择一个主机来呢</p></blockquote> <p>如果主机断开来凝结，我们可以手动<code>slaveof no one</code>让自己变成主机！其他节点就可以手动连接到最新的这个主节点，但全部为手动</p> <h3 id="哨兵模式-自动选择主机"><a href="#哨兵模式-自动选择主机" class="header-anchor">#</a> 哨兵模式（自动选择主机）</h3> <blockquote><p>概述</p></blockquote> <p>主从切换的方法是：当主机服务器宕机后，需要手动一台从机切换成主机服务器，这需要人工干预，费时费力，还会造成一段时间内服务不可用，所有更多时候，我们优先考虑哨兵模式。Redis从2.8开始正式提供了Sentinel（哨兵）架构来解决这个问题</p> <p>哨兵模式是一种特殊的模式，首先Redis提供了哨兵的命令，哨兵是一个独立的进程，作为进程，他会独立运行，原理是<strong>哨兵通过发送命令，等待Redis服务器响应，从而监控运行的多个Redis实例</strong>。</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200601140945876-1639133501747.png" alt="image-20200601140945876"></p> <p>这里哨兵有两个作用：</p> <ul><li>通过发送命令，让Redis服务器返回监控其运行状态，包括主服务器和从服务器</li> <li>当哨兵检测到master宕机，会自动将slave切换成master，然后通过发布订阅模式通知其他的从服务器，修改配置文件，让他们切换主机</li></ul> <p>然而一个哨兵进程对Redis服务器进行监控，可能会出现为问题，为此我们可以使用多个哨兵进行监控，各个哨兵还会互相监控，这就形成了多哨兵模式。</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200601141305795-1639133498133.png" alt="image-20200601141305795"></p> <p>假设主服务器宕机，哨兵1先检测到这个结果，系统不会马上进行failover过程，仅仅是哨兵1主管认为这个服务器不可用，这个现象为<strong>主观下线</strong>。当给后面的哨兵也检查到主服务器不可用，并且数量达到一定值时，那么哨兵间会进行一次投票，投票结果由一个哨兵发起，进行failover故障转移操作，切换成功后，就会通过发布订阅模式，让各个哨兵把自己监控的从服务器实现且换主机，这个过程成为<strong>客观下线</strong></p> <blockquote><p>测试</p></blockquote> <p>配置哨兵文件sentinel.conf</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># sentinel monitor 被监控名称 host port 1（代表主机挂了，从机投票） </span>
sentinel monitor myredis <span class="token number">127.0</span>.0.1 <span class="token number">6379</span> <span class="token number">1</span>
~          
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>启动哨兵</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@iZwz9ffkm6t8sepux4rpxuZ bin<span class="token punctuation">]</span><span class="token comment"># redis-sentinel myconfig/sentinel.conf</span>
<span class="token number">11574</span>:X 01 Jun <span class="token number">2020</span> <span class="token number">14</span>:26:22.763 <span class="token comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
<span class="token number">11574</span>:X 01 Jun <span class="token number">2020</span> <span class="token number">14</span>:26:22.763 <span class="token comment"># Redis version=6.0.3, bits=64, commit=00000000, modified=0, pid=11574, just started</span>
<span class="token number">11574</span>:X 01 Jun <span class="token number">2020</span> <span class="token number">14</span>:26:22.763 <span class="token comment"># Configuration loaded</span>
                _._                                                  
           _.-`<span class="token variable"><span class="token variable">`</span>__ <span class="token string">''</span>-._                                             
      _.-<span class="token variable">`</span></span><span class="token variable"><span class="token variable">`</span>    <span class="token variable">`</span></span><span class="token builtin class-name">.</span>  <span class="token variable"><span class="token variable">`</span>_.  <span class="token string">''</span>-._           Redis <span class="token number">6.0</span>.3 <span class="token punctuation">(</span>00000000/0<span class="token punctuation">)</span> <span class="token number">64</span> bit
  .-<span class="token variable">`</span></span><span class="token variable"><span class="token variable">`</span> .-<span class="token variable">`</span></span>`<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">.</span>  <span class="token variable">`</span></span>`<span class="token variable"><span class="token variable">`</span><span class="token punctuation">\</span>/    _.,_ <span class="token string">''</span>-._                                   
 <span class="token punctuation">(</span>    '      ,       .-<span class="token variable">`</span></span>  <span class="token operator">|</span> <span class="token variable"><span class="token variable">`</span>,    <span class="token punctuation">)</span>     Running <span class="token keyword">in</span> sentinel mode
 <span class="token operator">|</span><span class="token variable">`</span></span>-._<span class="token variable"><span class="token variable">`</span>-<span class="token punctuation">..</span>.-<span class="token variable">`</span></span> __<span class="token punctuation">..</span>.-.`<span class="token variable"><span class="token variable">`</span>-._<span class="token operator">|</span>'<span class="token variable">`</span></span> _.-<span class="token string">'|     Port: 26379
 |    `-._   `._    /     _.-'</span>    <span class="token operator">|</span>     PID: <span class="token number">11574</span>
  <span class="token variable"><span class="token variable">`</span>-._    <span class="token variable">`</span></span>-._  <span class="token variable"><span class="token variable">`</span>-./  _.-<span class="token string">'    _.-'</span>                                   
 <span class="token operator">|</span><span class="token variable">`</span></span>-._<span class="token variable"><span class="token variable">`</span>-._    <span class="token variable">`</span></span>-.__.-<span class="token string">'    _.-'</span>_.-<span class="token string">'|                                  
 |    `-._`-._        _.-'</span>_.-<span class="token string">'    |           http://redis.io        
  `-._    `-._`-.__.-'</span>_.-<span class="token string">'    _.-'</span>                                   
 <span class="token operator">|</span><span class="token variable"><span class="token variable">`</span>-._<span class="token variable">`</span></span>-._    <span class="token variable"><span class="token variable">`</span>-.__.-<span class="token string">'    _.-'</span>_.-'<span class="token operator">|</span>                                  
 <span class="token operator">|</span>    <span class="token variable">`</span></span>-._<span class="token variable"><span class="token variable">`</span>-._        _.-<span class="token string">'_.-'</span>    <span class="token operator">|</span>                                  
  <span class="token variable">`</span></span>-._    <span class="token variable"><span class="token variable">`</span>-._<span class="token variable">`</span></span>-.__.-<span class="token string">'_.-'</span>    _.-<span class="token string">'                                   
      `-._    `-.__.-'</span>    _.-<span class="token string">'                                       
          `-._        _.-'</span>                                           
              `-.__.-'                                               

<span class="token number">11574</span>:X 01 Jun <span class="token number">2020</span> <span class="token number">14</span>:26:22.764 <span class="token comment"># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span>
<span class="token number">11574</span>:X 01 Jun <span class="token number">2020</span> <span class="token number">14</span>:26:22.767 <span class="token comment"># Sentinel ID is 8fdec8ebebed9cd4736f4fb35e650de382c6ce30</span>
<span class="token number">11574</span>:X 01 Jun <span class="token number">2020</span> <span class="token number">14</span>:26:22.767 <span class="token comment"># +monitor master myredis 127.0.0.1 6379 quorum 1</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>==主机重连会变成从机==</p> <blockquote><p>哨兵模式</p></blockquote> <p>优点：</p> <ul><li>哨兵集群，基于主从复制</li> <li>主从可以切换，故障可以转移，系统可用性好</li> <li>哨兵模式就是主从模式的升级，自动切换</li></ul> <p>缺点：</p> <ul><li>Redis 不好在线扩容，集群容量一旦到达上限，在线扩容就十分麻烦</li> <li>实现哨兵模式的配置很麻烦，里面有很多选择</li></ul> <blockquote><p>哨兵模式的全部配置</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># Example sentine1. conf</span>
<span class="token comment">#哨兵sentine1实例运行的端口默认26379</span>
port <span class="token number">26379</span>
<span class="token comment">#哨兵sentine1的工作目录</span>
<span class="token function">dir</span> /tmp
I
<span class="token comment">#哨兵sentine1监控的redis主节点的ip port</span>
<span class="token comment"># master-name</span>
可以自己命名的主节点名字只能由字母A-z、数字0-9、这三个字符<span class="token string">&quot;.- &quot;</span>组成。
<span class="token comment"># quorum配置多少个sentine1哨兵统- -认为master主节点失联那么这时客观上认为主节点失联了</span>
牛sentine1 monitor <span class="token operator">&lt;</span>master-name<span class="token operator">&gt;</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;</span>ip<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>redis-port<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>quorum<span class="token operator">&gt;</span>
sentine1 monitor mymaster <span class="token number">127.0</span>.0.1 <span class="token number">6379</span> <span class="token number">2</span>
<span class="token comment">#当在Redis实例中开启 了requirepass foobared授权密码这样所有连接Redi s实例的客户端都要提供密码</span>
<span class="token comment">#设置哨兵sentinel 连接主从的密码注意必须为主从设置-样的验证密码</span>
<span class="token comment">#sentinel auth-pass &lt;master-name&gt; &lt;password&gt;</span>
sentine1 auth-pass mymaster MySUPER--secret-0123password

<span class="token comment">#指定多少亳秒之后主节点没有应答哨兵sentinel此时哨兵主观上认为主节点下线默认30秒</span>
<span class="token comment"># sentine1 down-after-milliseconds &lt;master-name&gt; &lt;mi 11iseconds&gt;</span>
sentine1 down-after-milliseconds mymaster <span class="token number">30000</span>
<span class="token comment">#这个配置项指定了在发生failover主备切换时最多可以有多少个slave同时对新的master进行同步，</span>
这个数字越小，完成failover所需的时间就越长，
但是如果这个数字越大，就意味着越多的slave因为replicati on而不可用。
可以通过将这个值设为1来保证每次只有一个slave处于不能处理命令请求的状态。
<span class="token comment"># sentine1 para1le1-syncs &lt;master-name&gt; &lt;nums laves&gt;</span>
sentine1 parallel-syncs mymaster <span class="token number">1</span>
<span class="token comment">#故障转移的超时时间fai lover-timeout可以用在以下这些方面:</span>
<span class="token comment">#1.同一个sentine1对同一 个master两次failover之间的间隔时间。</span>
<span class="token comment">#2.当一个s1ave从一 个错误的master那里同步数据开始计算时间。直到s lave被纠正为向正确的master那里同步数据时。</span>
<span class="token comment">#3.当想要取消一个正在进行的failover所需要的时间。</span>
<span class="token comment">#4.当进行failover时，配置所有slaves指向新的master所需的最大时间。不过，即使过了这个超时，slaves 依然会被正确配置为指向</span>
master,但是就不按paral1e1-syncs所配置的规则来了
<span class="token comment">#默认三分钟</span>
<span class="token comment"># sentine1 failover-timeout &lt;master-name&gt; &lt;milliseconds&gt;</span>
sentine1 failover-ti meout mymaster <span class="token number">180000</span>


<span class="token comment"># SCRIPTS EXECUTION</span>
<span class="token comment">#配置当某一事件发生时所需要执行的脚本，可以通过脚本来通知管理员，例如当系统运行不正常时发邮件通知相关人员。</span>
<span class="token comment">#对于脚本的运行结果有以下规则:</span>
<span class="token comment">#若脚本执行后返回1，那么该脚本稍后将会被再次执行，重复次数目前默认为10</span>
<span class="token comment">#若脚本执行后返回2，或者比2更高的一个返回值，脚本将不会重复执行。</span>
<span class="token comment">#如果脚本在执行过程中由于收到系统中断信号被终止了，则同返回值为1时的行为相同。</span>
<span class="token comment">#一个脚本的最大执行时间为60s，如果超过这个时间，脚本将会被-一个SIGKILL信 号终止，之后重新执行。</span>
<span class="token comment">#通知型脚本:当sentine1有任何警告级别的事件发生时( 比如说redis实例的主观失效和客观失效等等)，将会去调用这个脚本，这时这个</span>
脚本应该通过邮件，SMS 等方式去通知系统管理员关于系统不正常运行的信息。调用该脚本时，将传给脚本两个参数，- - 个是事件的类型，一
个是事件的描述。如果sentine1. conf配置文件中配置了这个脚本路径，那么必须保证这个脚本存在于这个路径，并且是可执行的，否则
sentine1无法正常启动成功。
<span class="token comment">#通知脚本</span>
<span class="token comment"># she11编程</span>
<span class="token comment"># sentine1 notificati on-script &lt;master-name&gt; &lt;script-path&gt;</span>
sentine1 notification-script mymaster /var/redis/notify. <span class="token function">sh</span>

<span class="token comment">#客户端重新配置主节点参数脚本</span>
<span class="token comment">#当一个master由于failover而发生改变时， 这个脚本将会被调用，通知相关的客户端关于master地址已经发生改变的信息。</span>
<span class="token comment">#以下参数将会在调用脚本时传给脚本:</span>
<span class="token comment"># &lt;master-name&gt; &lt;role&gt; &lt;state&gt; &lt;from-ip&gt; &lt;from-port&gt; &lt;to-ip&gt; &lt;to-port&gt;</span>
<span class="token comment">#目前&lt;state&gt; 总是&quot;“failover”,</span>
<span class="token comment"># &lt;role&gt;是“1eader&quot;或者“observer”中的一个。</span>
<span class="token comment">#参数from-ip，from-port， to-ip， to-port是用来和旧的master和新的master (即旧的slave)通信的</span>
<span class="token comment">#这个脚本应该是通用的，能被多次调用，不是针对性的。</span>
<span class="token comment"># sentine1 client-reconfig-script &lt;master-name&gt; &lt;script-path&gt;</span>
sentine1 client-reconfig-script mymaster /var/redis/reconfig. <span class="token function">sh</span> <span class="token comment">#一般都是由运维来配置</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><h2 id="redis缓存穿透和雪崩"><a href="#redis缓存穿透和雪崩" class="header-anchor">#</a> Redis缓存穿透和雪崩</h2> <p>Redis缓存的使用，极大的提升了应用程序的性能和效率，特别熟数据查询方面。但同时，他也带来了一些问题。其中，最要害的问题，就是数据一致性问题，从严格意义上来讲，这个问题无解，如果对数据的一致性要求很高，那么就不能使用缓存。</p> <p>另外的一些典型问题就是，缓存穿透、缓存雪崩和缓存击穿。目前，业界也有比较流行的解决方案</p> <h3 id="缓存穿透"><a href="#缓存穿透" class="header-anchor">#</a> 缓存穿透</h3> <blockquote><p>概念</p></blockquote> <p>比如，用户想要查询一个数据，发现redis内存数据没有，也就是缓存没有命中，于是像持久层数据库拆线呢。发现也没有，于是本次拆线呢失败，当用户很多的时候，缓存都没有命中，于是都去请求持久层数据库，这会给持久层数据库造成很大的压力，这时候相当于出现了缓存穿透。</p> <blockquote><p>解决方案</p></blockquote> <p><strong>布隆过滤器</strong></p> <p>布隆过滤器是一种数据结构，对所有可能查询的参数以hash形式储存，在控制从先进性校验，不符合则丢弃，从而避免了对底层储存系统的查询压力：</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200601145234156-1639133495468.png" alt="image-20200601145234156"></p> <p><strong>缓存空对象</strong></p> <p>当储存层不命中后，解释返回空对象也将其缓存起来，同时会设置一个过期时间，之后在访问这个数据会从缓存中获取，保护了后端数据源</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200601145433695-1639133492297.png" alt="image-20200601145433695"></p> <p>但是这种方法会存在两个问题：</p> <ul><li>如何空值被缓存起来，意味着需要更多空间储存更多的键，因为这当中很多可能为空值的键</li> <li>即使对空值设置了过期时间，还是会存在缓存和储存层的数据有一段时间窗口的不一致，这对于需要保持一致性的业务会有影响</li></ul> <h3 id="缓存击穿"><a href="#缓存击穿" class="header-anchor">#</a> 缓存击穿</h3> <blockquote><p>概述</p></blockquote> <p>是指一个key非常热点，在不停的进行大并发，大并发集中对这个一点进行访问，当这个key在失效的瞬间，持续的大并发就穿破缓存，直接请求数据库，就像凿开了一个洞</p> <p>当某个key在过期的瞬间，有大量请求并访问，这类数据一般是热点数据，由于缓存过期，会同时访问数据库来查询最新数据，并且会写混村，会导致数据库瞬间压力过大</p> <blockquote><p>解决方案</p></blockquote> <p><strong>设置热点数据永不过期</strong></p> <p>从缓存层面来看，没有设置过期使劲啊，所有不会出现热点key过期后产生的问题</p> <p><strong>加互斥锁</strong></p> <p>分布式锁：使用分布式锁，保证对于每个key同时只要一个线程去查询后端服务，其他线程没有获得分布式锁的权限，因此只需要等待即可，这种方式将高并发的要转移到分布式锁，因此对分布式锁的考验很大</p> <h3 id="缓存雪崩"><a href="#缓存雪崩" class="header-anchor">#</a> 缓存雪崩</h3> <blockquote><p>概念</p></blockquote> <p>缓存雪崩是指某个时间段内，缓存集中过期失效。或者Redis 宕机</p> <p>产生雪崩的原因之一，比如写文本的时候，马上就到到双十二0点，就会迎来一波抢购，这波商品时间比较集中的放入了缓存，假设缓存一个i下凹式，那么到了凌晨一点的后悔，这批商品的缓存就都过期了，而对这批商品的查询，都落到了数据库上，对于数据库而言，就会产生周期性的压力波峰。于是所有的请求都会达到储存层，储存层的调用量会暴增，造成储存层也会挂掉的情况。</p> <p><img src="https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200601150942225-1639133487443.png" alt="image-20200601150942225"></p> <p>其实集中过期,倒不是非常致命,比较致命的缓存雪崩,是缓存服务器某个节点宕机或断网。因为自然形成的缓存雪崩,一定是在某个时间段集中创建缓存,这个时候,数据库也是可以顶住压力的。无非就是对数据库产生周期性的压力而已。而缓存服务节点的宕机,对数据库服务器造成的压力是不可预知的,很有可能瞬间就把数据库压垮。</p> <blockquote><p>解决方案</p></blockquote> <p><strong>redis高可用</strong></p> <p>这个思想的含义是,既然redis有可能挂掉,那我多增设几台redis ,这样一台挂掉之 后其他的还可以继续工作,其实就是搭建的集群。</p> <p><strong>限流降级</strong></p> <p>这个解决方案的思想是,在缓存失效后,通过加锁或者队列来控制读数据库写缓存的线程数量。比如对某个key只允许一个线程查询数据和写缓存,其他线程等待。</p> <p><strong>数据预热</strong></p> <p>数据加热的含义就是在正式部署之前,我先把可能的数据先预先访问一遍,这样部分可能大量访问的数据就会加载到缓存中。在即将发送大并发访问前手动触发加载缓存不同的key，设置不同的过期时间，让缓存失效的时间点尽量均匀</p></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/yong-forever/yong-forever-blog/edit/master/docs/02.后端/40.学习笔记/30.《Redis》笔记.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/yong-forever-blog/tags/?tag=%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0" title="标签">#学习笔记</a><a href="/yong-forever-blog/tags/?tag=redis" title="标签">#redis</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/07/27, 22:17:49</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/yong-forever-blog/server/mysql/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">《Mysql》笔记</div></a> <a href="/yong-forever-blog/server/springcloud/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">《SpringCloud》笔记</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/yong-forever-blog/server/mysql/" class="prev">《Mysql》笔记</a></span> <span class="next"><a href="/yong-forever-blog/server/springcloud/">《SpringCloud》笔记</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/yong-forever-blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/yong-forever-blog/pages/c53048/"><div>Mysql面试题</div></a> <span>03-05</span></dt></dl><dl><dd>02</dd> <dt><a href="/yong-forever-blog/pages/3679e2/"><div>MyBatis面试题</div></a> <span>03-05</span></dt></dl><dl><dd>03</dd> <dt><a href="/yong-forever-blog/pages/3c0dc3/"><div>SpringBoot面试题</div></a> <span>03-05</span></dt></dl> <dl><dd></dd> <dt><a href="/yong-forever-blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:yong_forever@aliyun.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://gitee.com/yong-forever" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2024
    <span>Yiyong Zhan | <a href="https://gitee.com/yong-forever" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/yong-forever-blog/assets/js/app.61540ce8.js" defer></script><script src="/yong-forever-blog/assets/js/2.e7cba03d.js" defer></script><script src="/yong-forever-blog/assets/js/3.be5a514c.js" defer></script><script src="/yong-forever-blog/assets/js/42.9249fba3.js" defer></script>
  </body>
</html>
