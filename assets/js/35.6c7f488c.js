(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{363:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),a("h2",{attrs:{id:"docker学习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker学习"}},[s._v("#")]),s._v(" Docker学习")]),s._v(" "),a("blockquote",[a("p",[s._v("Docker 学习")])]),s._v(" "),a("ul",[a("li",[s._v("Docker概述")]),s._v(" "),a("li",[s._v("Docker安装")]),s._v(" "),a("li",[s._v("Docker命令\n"),a("ul",[a("li",[s._v("镜像命令")]),s._v(" "),a("li",[s._v("容器命令")]),s._v(" "),a("li",[s._v("操作命令")]),s._v(" "),a("li",[s._v("...")])])]),s._v(" "),a("li",[s._v("Docker镜像")]),s._v(" "),a("li",[s._v("容器数据卷")]),s._v(" "),a("li",[s._v("DockerFile")]),s._v(" "),a("li",[s._v("Docker网络原理")]),s._v(" "),a("li",[s._v("IDEA 整合 Docker")]),s._v(" "),a("li",[s._v("Docker Compose")]),s._v(" "),a("li",[s._v("Docker Swarm")]),s._v(" "),a("li",[s._v("CI\\CD Jenkins")])]),s._v(" "),a("h2",{attrs:{id:"docker概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker概述"}},[s._v("#")]),s._v(" Docker概述")]),s._v(" "),a("h3",{attrs:{id:"docker为什么出现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker为什么出现"}},[s._v("#")]),s._v(" Docker为什么出现？")]),s._v(" "),a("p",[s._v("一款产品：开发--上线 两套环境！ 应用环境、应用配置！")]),s._v(" "),a("p",[s._v("开发人员-----运维人员 ：我在我的电脑可以运行！版本更新，导致服务不可用！对于运维来说，考验就十分大？")]),s._v(" "),a("p",[a("strong",[s._v("开发即运维！")])]),s._v(" "),a("p",[s._v("环境配置是十分麻烦的，每一个机器都要部署环境（集群Redis、ES、Hadoop...）！费时费力")]),s._v(" "),a("p",[s._v("发布一个项目(jar（Redis Mysql jdk ES）)或者war...，项目能不能将环境一起安装打包！")]),s._v(" "),a("p",[s._v("之前在服务器一个应用的环境 Redis Mysql jdk ES hadoop，配置麻烦了，不能够跨平台。Windows，最后发布到Linux！")]),s._v(" "),a("p",[s._v("传统：开发jar，再运维来做！")]),s._v(" "),a("p",[s._v("现在：开发打包都上线，一套流程做完！")]),s._v(" "),a("p",[s._v("java -- apk -- 发布（应用商店）--使用apk --安装即可用")]),s._v(" "),a("p",[s._v("java -- jar（环境）-- 打包项目带上环境（镜像）-- （Dcoker仓库：商店）-- 下载我们发布的镜像 -- 运行即可")]),s._v(" "),a("p",[s._v("Docker给以上的问题，提出了解决方案！")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514192147975-1639134601368.png",alt:"image-20200514192147975"}})]),s._v(" "),a("p",[s._v("Docker的思想就来自于集装箱")]),s._v(" "),a("p",[s._v("JRE -- 多个应用（端口冲突）-- 原来都是交叉的！")]),s._v(" "),a("p",[s._v("隔离：Docker核心思想！打包装箱！每个箱子都是互相隔离的！")]),s._v(" "),a("p",[s._v("Docker 通过隔离机制，可以将服务器利用到极致！")]),s._v(" "),a("p",[s._v("本质：所有的技术都是因为出现了一些问题，我们需要去解决，采取学习！")]),s._v(" "),a("h3",{attrs:{id:"docker的历史"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker的历史"}},[s._v("#")]),s._v(" Docker的历史")]),s._v(" "),a("p",[s._v("2010年，几个搞IT的年轻人，就在美国成立了一家公司"),a("code",[s._v("dotCloud")])]),s._v(" "),a("p",[s._v("做一些pass的云计算服务！Linux 有关的容器技术！")]),s._v(" "),a("p",[s._v("他们将自己的技术 （容器化技术）命令 就是 Docker！")]),s._v(" "),a("p",[s._v("Docker 刚刚诞生的时候，没有引起行业的注意！dotCloud，活不下去！")]),s._v(" "),a("p",[a("code",[s._v("开源")])]),s._v(" "),a("p",[s._v("开发源代码！")]),s._v(" "),a("p",[s._v("2013年，Docker开源！")]),s._v(" "),a("p",[s._v("越来越多的人发现了docker的优点！火了，Docker 每一个月都会更新一个版本！")]),s._v(" "),a("p",[s._v("2014年4月9日，Docker1.0发布！")]),s._v(" "),a("p",[s._v("Docker为什么这么火？十分的qingqiao！")]),s._v(" "),a("p",[s._v("在容器技术出来之前，我们都是使用虚拟机技术！")]),s._v(" "),a("p",[s._v("虚拟机：在window中装一个 VMware，通过这个软件我们可以虚拟出来一台或者多台的电脑！笨重！")]),s._v(" "),a("p",[s._v("虚拟机也是属于虚拟化技术，Docker容器技术，也是一种虚拟化技术！")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("vm，linux centos原生镜像（一个电脑） 隔离，需要开启多个虚拟机 几个G 几分钟\ndocker：隔离，镜像（最核心的环境 jdk+mysql+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".）十分的小巧，运行环境就可以了！几个M KB 几秒\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("到现在，所有开发人员都要学会Docker！")]),s._v(" "),a("blockquote",[a("p",[s._v("聊聊Docker")])]),s._v(" "),a("p",[s._v("Docker 是基于 Go 语言开发的！开源项目！")]),s._v(" "),a("p",[s._v("官网：https://www.docker.com/")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514193903348-1639134605079.png",alt:"image-20200514193903348"}})]),s._v(" "),a("p",[s._v("文档：https://docs.docker.com/ Docker的文档是超级详细的！")]),s._v(" "),a("p",[s._v("仓库地址：https://hub.docker.com/")]),s._v(" "),a("h3",{attrs:{id:"docker能干嘛"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker能干嘛"}},[s._v("#")]),s._v(" Docker能干嘛")]),s._v(" "),a("blockquote",[a("p",[s._v("之前的虚拟机技术！")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514194241959-1639134612146.png",alt:"image-20200514194241959"}})]),s._v(" "),a("p",[s._v("虚拟机技术缺点：")]),s._v(" "),a("ol",[a("li",[s._v("资源占用十分多")]),s._v(" "),a("li",[s._v("荣誉步骤多")]),s._v(" "),a("li",[s._v("启动很慢")])]),s._v(" "),a("blockquote",[a("p",[s._v("容器化技术")])]),s._v(" "),a("p",[a("font",{attrs:{color:"red"}},[s._v("容器化技术不是模拟的一个完整的操作系统")])],1),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514194535196-1639134615548.png",alt:"image-20200514194535196"}})]),s._v(" "),a("p",[s._v("比较Docker和虚拟机技术的不同：")]),s._v(" "),a("ul",[a("li",[s._v("传统虚拟机、虚拟出一条因该你，运行一个完整的操作系统，然后在这个系统上安装和运行软件")]),s._v(" "),a("li",[s._v("容器内的应用直接运行在 宿主机的内容，容器时没有自己的内核的，也没有虚拟我们的硬件，所以就轻便了")]),s._v(" "),a("li",[s._v("每个容器相互管理，每一个容器内都有一个自己的文件系统，互不影响")])]),s._v(" "),a("blockquote",[a("p",[s._v("DevOps (开发、运维)")])]),s._v(" "),a("p",[a("strong",[s._v("应用更快速的交付和部署")])]),s._v(" "),a("p",[s._v("传统：一堆帮助文档，安装程序")]),s._v(" "),a("p",[s._v("Docker：一键运行，打包镜像发布测试")]),s._v(" "),a("p",[a("strong",[s._v("更便捷的升级和扩缩容")])]),s._v(" "),a("p",[s._v("使用了Docker之后，我们部署应用就和搭积木一样！")]),s._v(" "),a("p",[s._v("（SpringBoot 1.5\tRedis 5 \ttomcat 8 ）升级")]),s._v(" "),a("p",[s._v("项目打包为一个镜像，扩展，服务器A！服务器B")]),s._v(" "),a("p",[a("strong",[s._v("更简单的系统运维")])]),s._v(" "),a("p",[s._v("在容器化之后，我们的开发，测试环境都是高度一致的。")]),s._v(" "),a("p",[a("strong",[s._v("更高效的计算资源利用")])]),s._v(" "),a("p",[s._v("Docker 是内核级别的虚拟化，可以再一个物理机上运行很多的容器实例！服务器的性能可以被压榨到极致。")]),s._v(" "),a("h2",{attrs:{id:"docker安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker安装"}},[s._v("#")]),s._v(" Docker安装")]),s._v(" "),a("h3",{attrs:{id:"docker的基本组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker的基本组成"}},[s._v("#")]),s._v(" Docker的基本组成")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/u=378500507,2500759843&fm=15&gp=0-1639134618459.jpg",alt:"img"}})]),s._v(" "),a("p",[a("strong",[s._v("镜像（image）")]),s._v("：")]),s._v(" "),a("p",[s._v("docker镜像就好比是一个模板，可以通过这个模板来创建容器服务，tomcat镜像== >run ==>tomcat01 容器（提供服务器），通过这个镜像可以创建多个容器（最终服务运行或者项目运行就是在容器中的）")]),s._v(" "),a("p",[a("strong",[s._v("容器（container）")]),s._v("：")]),s._v(" "),a("p",[s._v("Docker利用容器技术，独立运行一个或者一个组应用，通过镜像来创建。")]),s._v(" "),a("p",[s._v("启动，停止，删除，基本命令！")]),s._v(" "),a("p",[s._v("目前就可以把这个容器理解为一个建议的linux系统")]),s._v(" "),a("p",[a("strong",[s._v("仓库（repositiory）")]),s._v("：")]),s._v(" "),a("p",[s._v("仓库就是存放镜像的地址！")]),s._v(" "),a("p",[s._v("仓库分为公有仓库和私有仓库！")]),s._v(" "),a("p",[s._v("Docker Hub（默认是国外的）")]),s._v(" "),a("p",[s._v("阿里云等都有容器服务器（配置镜像加速！）")]),s._v(" "),a("h3",{attrs:{id:"安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[s._v("#")]),s._v(" 安装Docker")]),s._v(" "),a("blockquote",[a("p",[s._v("环境准备")])]),s._v(" "),a("ol",[a("li",[s._v("需要会一点带你的linux的基础")]),s._v(" "),a("li",[s._v("CentOS 7")]),s._v(" "),a("li",[s._v("我们需要使用Xshell 连接远程服务器进行操作！")])]),s._v(" "),a("blockquote",[a("p",[s._v("环境查看")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /ect/os/os-release\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("帮助文档:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.卸载旧的版本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client-latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-common "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest-logrotate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-logrotate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-engine\n                  \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.需要的安装包")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" yum-utils\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3.设置镜像仓库")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --add-repo https://0bypmxdk.mirror.aliyuncs.com\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#默认国外地址    https://download.docker.com/linux/centos/docker-ce.repo")]),s._v("\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#更新 yum ")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum makecache fast\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#4.安装docker ce社区 ee企业版")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5.启动docker")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#6.查看版本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#7.hello-world")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#8.查看一下 下载的这个镜像")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("2.卸载")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.卸载资源")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove docker-ce docker-ce-cli containerd.io\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.删除资源")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/docker\n\n/var/lib/docker 默认工作路径\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("3.配置使用")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /etc/docker\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n  "registry-mirrors": ["https://0bypmxdk.mirror.aliyuncs.com"]\n}\nEOF')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h4",{attrs:{id:""}},[a("a",{staticClass:"header-anchor",attrs:{href:"#"}},[s._v("#")])]),s._v(" "),a("h4",{attrs:{id:"回顾helloworld流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#回顾helloworld流程"}},[s._v("#")]),s._v(" 回顾helloworld流程")]),s._v(" "),a("h3",{attrs:{id:"底层原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#底层原理"}},[s._v("#")]),s._v(" 底层原理")]),s._v(" "),a("p",[a("strong",[s._v("Docker是怎么工作的？")])]),s._v(" "),a("p",[s._v("Docker是一个Client-Server结构的系统，Docker的守护进程运行在主机上，通过Socket从客户端访问！")]),s._v(" "),a("p",[s._v("DockerServer接收到Docker-Client指令,就会执行这个命令")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514202922893-1639134621439.png",alt:"image-20200514202922893"}})]),s._v(" "),a("p",[a("strong",[s._v("Docker为什么比VM快？")])]),s._v(" "),a("ol",[a("li",[s._v("Docker有着比虚拟机更少的抽象层")]),s._v(" "),a("li",[s._v("docker利用的是宿主机的内核，vm需要时Guest OS")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/timg-1639134624921.jpg",alt:"img"}})]),s._v(" "),a("p",[s._v("所以新建一个容器的时候，docker不需要像虚拟机一样加载一个操作系统内核，避免引导界面，虚拟机加载Guest OS，而docker是利用宿主机的操作系统，省略了复杂的进程")]),s._v(" "),a("h3",{attrs:{id:"docker的常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker的常用命令"}},[s._v("#")]),s._v(" Docker的常用命令")]),s._v(" "),a("h4",{attrs:{id:"帮助命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#帮助命令"}},[s._v("#")]),s._v(" 帮助命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示docker的版本信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示docker的详细信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#帮助命令")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("帮助文档的地址：https://docs.docker.com/reference/")]),s._v(" "),a("h4",{attrs:{id:"镜像命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像命令"}},[s._v("#")]),s._v(" 镜像命令")]),s._v(" "),a("p",[a("strong",[s._v("docker images")]),s._v(" 查看所有本地主机的镜像")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\nREPOSITIORY 镜像的仓库\nTAG\t\t\t镜像的标签\nIMAGE ID\t镜像的id\nCREATED\t\t镜像的创建时间\nSIZE\t\t镜像的大小\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#可选项")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示所有镜像信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示所有镜像id")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[a("strong",[s._v("docker镜像搜索")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search mysql \n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#可选项，通过收藏过滤")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--filter")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("STARS"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#收藏大于3000的")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("strong",[s._v("docker pull下载镜像")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker pull io/lib/mysql：laster")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull 镜像名[tag] 不写tag默认最新版本")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql5.7 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定版本下载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#分层下载，docker image的核心 联合文件系统 5.7与8.0相同文件不会再下载 共有")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("strong",[s._v("docker remove删除镜像")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" 镜像id "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除指定id镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" 镜像id 镜像id 镜像id "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除多个镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" -"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${docker images -aq}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除多个镜像")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"容器命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器命令"}},[s._v("#")]),s._v(" 容器命令")]),s._v(" "),a("p",[a("strong",[s._v("说明：我们有了镜像才可以创建容器，linux，下载一个centos镜像来测试学习")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull centos\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("新建容器并启动")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("可选参数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" image\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参数说明")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"名字"')]),s._v("\t容器名字 tomcat01，tomcat02，区分容器\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\t\t\t后台运行\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v("\t\t\t使用交互运行，进入容器查看内容\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" \t\t\t指定容器端口 -p8080：8081\n\t"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" ip:主机端口：容器端口\n\t-p主机端口：容器端口（常用）\n\t-p容器端口\n\t容器端口\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("\t\t随机指定端口\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" 用完即删 测试用\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#调试、启动并进入容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" centos /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#退出容器")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("查看运行的容器")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可选项")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#列出当前正在运行的容器+历史运行过的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("? "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示最佳创建的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#只显示容器编号")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("退出容器")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#退出容器并停止")]),s._v("\nctrl+P+Q "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#退出容器不停止")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("删除容器")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 容器id "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除指定id容器，运行的容器不能删除 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${docker ps -aq}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除所有id容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" -q"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除所有容器")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("启动和停止容器")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start 容器id\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart 容器id\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop 容器id\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" 容器id\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#强制停止")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"常用的其他命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用的其他命令"}},[s._v("#")]),s._v(" 常用的其他命令")]),s._v(" "),a("p",[s._v("后台启动容器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker run -d 镜像名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" centos "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止了")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#常见的坑 docker容器使用后台运行，如果没有前台进程，就会自动停止")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("strong",[s._v("查看日志")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示日志")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-tf")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示日志")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-tail")]),s._v(" num "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示日志条数")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker logs -f -t --tail num 容器id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-tf")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 容器id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[a("strong",[s._v("查看容器中进程信息")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#命令 docker top 容器id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" 容器id\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" 容器id\n\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v("\ndokcer inspect 容器id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("strong",[s._v("进入当前运行的容器")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#我们通常容器都是后台方式运行的，需要进入容器，修改配置")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#命令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" 容器id /bin/bash  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入新的终端窗口(常用)")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#方式二")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" attach 容器id /bin/bash "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入当前的终端窗口")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("strong",[s._v("从容器拷贝文件到主机上")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 主机路径\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.进入容器内部")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" attach 容器id\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.在容器内新建文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" yong.java\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3.推出容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#4.将文件拷贝出来到主机上")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 容器id:/home/test.java /home\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拷贝是一个手动过程，未来我们使用 -卷的技术，可以实现")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h4",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514214450812-1639134629228.png",alt:"image-20200514214450812"}})]),s._v(" "),a("h4",{attrs:{id:"练习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#练习"}},[s._v("#")]),s._v(" 练习")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search tomcat\ndocke pull tomcat\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3355")]),s._v(":8080 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tomcat01 tomcat\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" tomcat01 /bin/bash\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#问题：1.linux命令少了 2.没有webapps 、阿里云镜像的原因，默认最小的镜像，所有不必要的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" webapps.dist/* webapps\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("blockquote",[a("p",[s._v("部署es+kibana")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# es 暴露的端口很多")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# es 十分的耗内存")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# es 的数据一般要放逐到安全目录！挂在")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" elasticsearch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v(":9300 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovery.type=single-node"')]),s._v(" elasticsearch:7.6.2\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这会非常的卡卡卡卡卡")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker stats 查看cpu状态")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# es 是十分耗内存的")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 docker stats")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试 es是否成功了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" localhost:9200\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 赶紧关掉，增加内存的限制，修改配置文件 -e 环境配置修改")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" elasticsearch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v(":9300 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovery.type=single-node"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" ES_JAVA-OPTS"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Xms64m -Xmx512m"')]),s._v(" elasticsearch:7.6.2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("作业：使用kibana")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514222610085-1639134632267.png",alt:"image-20200514222610085"}})]),s._v(" "),a("h4",{attrs:{id:"可视化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可视化"}},[s._v("#")]),s._v(" 可视化")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("portainer(先用这个)")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),s._v(":9000 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /var/run/docker.sock:/var/run/docker.sock "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),s._v(" protainer/portainer\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("Rancher(CI/CD 再用)")])])]),s._v(" "),a("p",[a("strong",[s._v("什么是protainer")])]),s._v(" "),a("p",[s._v("Docker 图形界面管理工具！提供一个后台面板提供我们操作！")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),s._v(":9000 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /var/run/docker.sock:/var/run/docker.sock "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),s._v(" protainer/portainer\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("访问测试：http://ip:8088/")]),s._v(" "),a("h2",{attrs:{id:"docker镜像讲解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker镜像讲解"}},[s._v("#")]),s._v(" Docker镜像讲解")]),s._v(" "),a("h4",{attrs:{id:"镜像是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像是什么"}},[s._v("#")]),s._v(" 镜像是什么")]),s._v(" "),a("p",[s._v("镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。")]),s._v(" "),a("p",[s._v("如何得到镜像：")]),s._v(" "),a("ul",[a("li",[s._v("从远程仓库下载")]),s._v(" "),a("li",[s._v("朋友拷贝")]),s._v(" "),a("li",[s._v("自己制作")])]),s._v(" "),a("h4",{attrs:{id:"docker镜像加载原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker镜像加载原理"}},[s._v("#")]),s._v(" Docker镜像加载原理")]),s._v(" "),a("blockquote",[a("p",[s._v("UnionFS（联合文件系统）")])]),s._v(" "),a("p",[s._v("UnionFS（联合文件系统）：Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同事可以将不同目录挂载到同一个虚拟文件系统下（Unite serveral directories into a single virtual filesystem）。Union文件系统是Docker的基础。镜像可以通过分层来继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。")]),s._v(" "),a("p",[s._v("特性：一次同时加载多个文件系统，但是从外面看来，只能看到一个文件系统，来拟合加载会把各层文件系统叠加卡里，这样最终的文件系统会包含所有的底层和文件目录")]),s._v(" "),a("blockquote",[a("p",[s._v("Docker镜像加载原理")])]),s._v(" "),a("p",[s._v("docker的镜像实际上是由一层一层的文件系统组成，这种层级的文件系统UnionFS。")]),s._v(" "),a("p",[s._v("bootfs（boot file system）主要包含bootloader和kernel，bootloader主要引导加载kernel，Linux刚启动时会加载bootfs文件系统，再Docker镜像的最底层是bootfs。这一层与我们典型的Linux/Unix系统是一样的，包含boot加载器和内核。当boot加载完成之后整个内核就在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。")]),s._v(" "),a("p",[s._v("rootfs（root file sytem），再bootfs之上，包含的就是典型Linux系统中的/dev，/proc，/bin，/etc等标准目录和文件，rootfs就是各种不同的操作系统的发行版，比如Ubuntu，CentOS等等。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514230413951-1639134636281.png",alt:"image-20200514230413951"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514230531286-1639134641463.png",alt:"image-20200514230531286"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514230800112-1639134645915.png",alt:"image-20200514230800112"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514230920123-1639134648973.png",alt:"image-20200514230920123"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514231014722-1639134652164.png",alt:"image-20200514231014722"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200514231152698-1639134655314.png",alt:"image-20200514231152698"}})]),s._v(" "),a("h4",{attrs:{id:"commit镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commit镜像"}},[s._v("#")]),s._v(" commit镜像")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit 提交容器成为一个新的副本\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"提交的描述信息"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"作者"')]),s._v(" 目标镜像名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("TAG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" 容器id /bin/bash\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("实战测试")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动一个默认的tamcat")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发现这个默认的tomcat 是没有webapps应用")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拷贝进去基本的文件")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将给我们的容器通过commit提交为一个镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yong"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"add webapps app"')]),s._v(" 容器id tomcat02:1.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"容器数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器数据卷"}},[s._v("#")]),s._v(" 容器数据卷")]),s._v(" "),a("h3",{attrs:{id:"什么是容器数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是容器数据卷"}},[s._v("#")]),s._v(" 什么是容器数据卷")]),s._v(" "),a("p",[a("strong",[s._v("docker的理念回顾")])]),s._v(" "),a("p",[s._v("讲应用和环境打包成一个镜像！")]),s._v(" "),a("p",[s._v("数据？如果数据都早容器中，那么我们容器和三处，数据就会丢失！需求：数据可以持久化")]),s._v(" "),a("p",[s._v("Mysql，容器删了，数据就没了！Mysql数据可以储存到本地")]),s._v(" "),a("p",[s._v("容器之间可以有一个数据共享的技术！Docker容器中产生的数据，同步到本地！")]),s._v(" "),a("p",[s._v("这就是卷技术！目录的瓜子，将我们的容器内的目录，挂载到linux上面！")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515190846545-1639134688682.png",alt:"image-20200515190846545"}})]),s._v(" "),a("p",[a("strong",[s._v("总结一句话：容器的持久化和同步操作！容器间可是可以数据共享的")])]),s._v(" "),a("h3",{attrs:{id:"使用数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用数据卷"}},[s._v("#")]),s._v(" 使用数据卷")]),s._v(" "),a("blockquote",[a("p",[s._v("方式一：直接使用命令 -v")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" 主机目录:容器内目录 \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#测试")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /home/ceshi:/home centos /bin/bash\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动起来之后 通过 docker inspect 容器id  查看")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("双向绑定")]),s._v(" "),a("p",[s._v("再来测试")]),s._v(" "),a("ol",[a("li",[s._v("停止容器")]),s._v(" "),a("li",[s._v("修改宿主机上的文件")]),s._v(" "),a("li",[s._v("启动容器")]),s._v(" "),a("li",[s._v("发现容器文件同步了宿主机")])]),s._v(" "),a("p",[s._v("好处：我们修改只需要再本地修改即可，容器会自动同步")]),s._v(" "),a("h3",{attrs:{id:"实战-安装mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实战-安装mysql"}},[s._v("#")]),s._v(" 实战：安装MySQL")]),s._v(" "),a("p",[s._v("思考：mysql的数据持久化问题!")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515192713361-1639134692569.png",alt:"image-20200515192713361"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#下载镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql:5.7\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行容器，需要进行挂载 #安装启动mysql的时候 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("my-secret-pw\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动我们的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" 后台运行\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" 端口映射\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" 挂载\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" 容器名字\n\ndovker run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /home/mysql/conf:/etc/mysql/conf.d -v/home/mysql/data:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql01 mysql:5.7\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动之后，我们再本地使用sqlyog来调试一下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sqlyog连接3306 和容器")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#本地测试创建一个数据，查看一下映射配置是否成功")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("假设我们将容器删除")]),s._v(" "),a("p",[s._v("发现，我们挂载到本地的数据卷依旧没有丢失，实现了容器数据化功能！")]),s._v(" "),a("h3",{attrs:{id:"具名和匿名挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#具名和匿名挂载"}},[s._v("#")]),s._v(" 具名和匿名挂载")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#匿名挂载")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" 容器内路径！\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" name niginx01 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /ect/nginx nginx "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#没有指定主机路径")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker volume --help")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看所有卷的情况")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这发现,这中就是匿名挂载，我们 -v 只写了容器内路径，没有写容器外路径")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#具名    卷名:容器内路               juming-nginx前面不要写/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" name niginx01 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" juming-nginx:/ect/nginx nginx\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看这个卷 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect juming-nginx\n \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("所有的docker内的卷 cd /var/lib/docker/volumes/xxx/_data")]),s._v(" "),a("p",[s._v("我们通过具名可方便我们找到一个卷，大多数使用"),a("code",[s._v("具名挂载")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如何确定具名挂载还是匿名挂载，还是指定路径挂载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" 容器内路径 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#匿名挂载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" 具名:容器内路径 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#具名挂载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" 宿主机路径:容器内路径 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#路径挂载")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("扩展：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过 -v 容器内陆就 ro rw 改变独秀权限")]),s._v("\nro "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("readonly")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#只读")]),s._v("\nrw readwrite "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#可读可写")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" nginx02 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" juming-nginx:/etc/nginx:ro niginx\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" nginx02 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" juming-nginx:/etc/nginx:rw niginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ro 说明这个路径只能通过宿主机操作，容器内是无法操作的")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"初识dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初识dockerfile"}},[s._v("#")]),s._v(" 初识Dockerfile")]),s._v(" "),a("p",[s._v("Dockerfile 就是用来构建 docker镜像的构建文件!命令脚本！")]),s._v(" "),a("blockquote",[a("p",[s._v("方式二")])]),s._v(" "),a("p",[s._v("通过这个脚本可以生成镜像，镜像是一层一层的，脚本是一个命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建一个dockefile文件，名字建议DockerFile")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" docker-test-volume\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" dockerfile1\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#文件中的内容 指令大写")]),s._v("\nFROM centos\nVOLUME "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume01"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume02"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nCMD "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-------end--------"')]),s._v("\nCMD /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这里的每一个镜像就是一个命令")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /home/docker-test-volume/dockerfile1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" yong/centos:1.0\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" 容器id /bin/bash\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("这个（匿名）卷一定和外部有一个同步的目录")]),s._v(" "),a("p",[s._v("docker inspect 容器id 确实是一个匿名卷")]),s._v(" "),a("p",[s._v("这种方式我们未来使用的十分多，因为我们通常会构建自己的镜像！")]),s._v(" "),a("p",[s._v("假设构建镜像的时候没有挂载卷，要手动镜像 -v 挂载")]),s._v(" "),a("h3",{attrs:{id:"数据卷容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷容器"}},[s._v("#")]),s._v(" 数据卷容器")]),s._v(" "),a("p",[s._v("多个mysql同步数据")]),s._v(" "),a("p",[s._v("命名的容器挂载数据卷")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515200356210-1639134696062.png",alt:"image-20200515200356210"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过刚才的镜像 测试多个容器 这里是实例centos，centos，centos，centos")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v(" docker01 镜像id \n\nctrl+p+q退出当前容器\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#--volume-from 实现容器间的共享")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#绑定docker01 ，类似java继承,不需要写镜像id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v(" docker02 --volume-from docker01 yong/centos:1.0\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在进入docker01")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" volumen01 \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" d01.txt\n\nctrl+p+q退出当前容器\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在进入docker02")]),s._v("\nvolumen01 下 也有d01.txt\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多个继承挂载是一样的")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只要还有容器还在用数据，不管删除哪一个容器，数据都不会删除")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据卷容器的生命周期一直持续到没有容器使用为止")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" DockerFile")]),s._v(" "),a("h3",{attrs:{id:"dockerfile介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile介绍"}},[s._v("#")]),s._v(" Dockerfile介绍")]),s._v(" "),a("p",[s._v("dockerfile是用来构建docker镜像的文件！命令参数脚本")]),s._v(" "),a("p",[s._v("构建步骤：")]),s._v(" "),a("ol",[a("li",[s._v("编写一个dockerfile文件")]),s._v(" "),a("li",[s._v("docker build 构建成为一个镜像")]),s._v(" "),a("li",[s._v("docker run 运行镜像")]),s._v(" "),a("li",[s._v("docker push 发布镜像（DockerHub，阿里云镜像仓库）")])]),s._v(" "),a("p",[s._v("查看官方是怎么做的")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515203518847-1639134699571.png",alt:"image-20200515203518847"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515203602841-1639134706086.png",alt:"image-20200515203602841"}})]),s._v(" "),a("p",[s._v("很多官方的镜像都是基础包，很多功能没有，我们需要通常会自己搭建自己的镜像！")]),s._v(" "),a("p",[s._v("官方可以，我们也可以制作镜像！")]),s._v(" "),a("h3",{attrs:{id:"dockerfile构建过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile构建过程"}},[s._v("#")]),s._v(" DockerFile构建过程")]),s._v(" "),a("p",[a("strong",[s._v("基础知识：")])]),s._v(" "),a("ol",[a("li",[s._v("每一个保留关键字（指令）都必须是大写字母")]),s._v(" "),a("li",[s._v("执行从上到下")]),s._v(" "),a("li",[s._v("#表示注释")]),s._v(" "),a("li",[s._v("每一个指令都会创建提交一个新的镜像层，")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515204024998-1639134711636.png",alt:"image-20200515204024998"}})]),s._v(" "),a("p",[s._v("dockerfile是面向开发的，我们以后要发布项目，做镜像，就需要编写dockerfile文件，这个文件十分简单！")]),s._v(" "),a("p",[s._v("Docker镜像逐渐成为企业交付的标准，必须掌握！")]),s._v(" "),a("p",[s._v("DockerFile：构建文件，定义了一切的步骤，源代码")]),s._v(" "),a("p",[s._v("DockerImages：通过DockerFile构建生成的镜像，最终发布和运行的产品")]),s._v(" "),a("p",[s._v("Docker容器：容器就是镜像运行起来提供服务器")]),s._v(" "),a("h3",{attrs:{id:"dockerfile的指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile的指令"}},[s._v("#")]),s._v(" DockerFile的指令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("FROM\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#基础镜像,一切从这里构建 centos")]),s._v("\nMAINTAINER\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#镜像是谁写的，姓名+邮箱")]),s._v("\nRUN\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#镜像构建的时候需要运行的命令")]),s._v("\nADD\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#步骤，tomcat镜像，这个tomcat压缩包，添加内容")]),s._v("\nWORKDIR\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#镜像的工作目录")]),s._v("\nVOLUME\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#挂载的目录")]),s._v("\nEXPOSE\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定暴露端口")]),s._v("\nRUN\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#最终运行")]),s._v("\nCMD\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定这个容器启动时要运行的命令,只要最后一个会生效，可被替代")]),s._v("\nENTRYPOINT\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定这个容器启动时要运行的命令，可以追加命令")]),s._v("\nONBUILD\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#当构建一个被继承 DockerFile 这时候会允许 ONBUILD 的指令")]),s._v("\nCOPY\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#类似ADD命令，将我们的文件拷贝到镜像中")]),s._v("\nENV\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#构建的时候设置环境变量")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h4",{attrs:{id:"实战测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实战测试"}},[s._v("#")]),s._v(" 实战测试")]),s._v(" "),a("p",[s._v("Docker Hub 中 99% 都是从基础镜像过来的 From srcatch，然后配置需要的软件和配置来进行的构建")]),s._v(" "),a("blockquote",[a("p",[s._v("创建一个自己的centos")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" dockerfiles\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" mydfcentos\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#编写mydfcentos文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("\nFROM centos\nMAINTAINER yong"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1258225956")]),s._v("@qq.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\nENV MYPATH /usr/local\nWORKDIR $MYPATH\n\nRUN yum "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加vim")]),s._v("\nRUN yum "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" net-tools "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加网络")]),s._v("\n\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n\nCMD "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" $MYPATH\nCMD "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"---end---"')]),s._v("\n\nCMD /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#构建-f dockerfile文件路径 -t 镜像名[TAG]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" mydfcentos "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" mycentos:1.0 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这里有一点")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" mycentos:1.0 \n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),s._v(" 进入工作目录对应 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ENV MYPATH /usr/local WORKDIR $MYPATH")]),s._v("\n\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("p",[s._v("我们可以查看官方的镜像生成记录")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看生成记录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" 镜像id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("CMD命令和ENTRYPOINT命令的区别")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("CMD\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定这个容器启动时要运行的命令,只要最后一个会生效，可被替代")]),s._v("\nENTRYPOINT\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定这个容器启动时要运行的命令，可以追加命令")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#测试CMD")]),s._v("\nFROM centos\nCMD "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入就会自动展开ls -a")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run 镜像id "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不能追加命令")]),s._v("\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#测试ENTRYPOINT ")]),s._v("\nENTRYPOINT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run 镜像id "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#可以追加命令 追加成 ls -a -l")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h4",{attrs:{id:"实现-tomcat镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现-tomcat镜像"}},[s._v("#")]),s._v(" 实现：Tomcat镜像")]),s._v(" "),a("ol",[a("li",[s._v("准备镜像文件 tomcat 压缩包，jdk的压缩包！")]),s._v(" "),a("li",[s._v("编写dockerfile文件")]),s._v(" "),a("li")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" tomcat\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" tomcat \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加 tomcat 压缩包，jdk的压缩包")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" readme.txt "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#帮助文档")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" Dockerfile "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#官方命令 Dockerfile 不需要写 -f 查找路径")]),s._v("\n\nFROM centos\nMAINTAINER yong"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1258225956")]),s._v("@qq.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\nCOPY readme.txt /useer/local/readme.txt\n\nADD jdk.xxxx.tar.gz /user/local/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ADD 自动解压缩")]),s._v("\nADD apche.tomcat.xxxx.tar.gz /user/local/\n\nRUN yum "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加vim")]),s._v("\n\nENV MYPATH /usr/local\nWORKDIR "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\n\nENV JAVA_HOME /usr/local/jdk_xxxx\nENV ClASSPATH "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar\nENV CATALINA_HOME /usr/local/apache-tomcat.xxx\nENV CATALINA_BASH /usr/local/apache-tomcat.xxx\nENV "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PATHJAVA_HOME")]),s._v("/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALINA_HOME")]),s._v("/lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATELINA_HOME")]),s._v("/bin\n\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n\nCMD /usr/local/apche-tomcat-xxxx/bin/startup.sh %% "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-F")]),s._v(" /url/local/apche-tomcat-xxxx/bin/logs/catalina.out\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515212815661-1639134716962.png",alt:"image-20200515212815661"}})]),s._v(" "),a("p",[s._v("3、构建镜像")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker build -t diytomcat")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("4、启动镜像")]),s._v(" "),a("p",[s._v("5、测试")]),s._v(" "),a("p",[s._v("6、发布项目")]),s._v(" "),a("h4",{attrs:{id:"发布自己的镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发布自己的镜像"}},[s._v("#")]),s._v(" 发布自己的镜像")]),s._v(" "),a("blockquote",[a("p",[s._v("DockerHub")])]),s._v(" "),a("ol",[a("li",[a("p",[s._v("注册自己账号并登录")])]),s._v(" "),a("li",[a("p",[s._v("在我们的服务器上提交自己的镜像")])]),s._v(" "),a("li",[a("p",[s._v("登录")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" login "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" login "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag 镜像名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("TAG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改tag")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("docker push 作者/镜像[TAG]")])])]),s._v(" "),a("p",[s._v("提交的时候也是按照层级进行提交的")]),s._v(" "),a("blockquote",[a("p",[s._v("阿里云镜像服务上")])]),s._v(" "),a("ol",[a("li",[s._v("登录阿里云")]),s._v(" "),a("li",[s._v("找到容器镜像服务")]),s._v(" "),a("li",[s._v("创建命名空间")]),s._v(" "),a("li",[s._v("创建容器镜像")]),s._v(" "),a("li",[s._v("浏览阿里云页面，操作介绍十分详细")])]),s._v(" "),a("h4",{attrs:{id:"小结-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结-2"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515220504564-1639134720767.png",alt:"image-20200515220504564"}})]),s._v(" "),a("h2",{attrs:{id:"docker网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker网络"}},[s._v("#")]),s._v(" Docker网络")]),s._v(" "),a("h3",{attrs:{id:"理解docker0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#理解docker0"}},[s._v("#")]),s._v(" 理解Docker0")]),s._v(" "),a("p",[s._v("清空所有环境")]),s._v(" "),a("blockquote",[a("p",[s._v("测试")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515223221334-1639134724829.png",alt:"image-20200515223221334"}})]),s._v(" "),a("p",[s._v("三个网络")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 问题 docker 是如何处理网络访问的?")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tamcat01 tomcat\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看容器的内部网络地址 ip addr会得到一个 eht0@if262 ip地址，docker分配的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" tomcat01 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" addr\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#服务器（宿主机）可以ping通docker 容器内部")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("blockquote",[a("p",[s._v("原理")])]),s._v(" "),a("ol",[a("li",[a("p",[s._v("我们每启动一个docker容器，docker就会给其分配一个ip，我们只要安装了docker，就会有一个网卡docker0交接模式，使用的技术是veth-pair技术！再次测试 ip addr"),a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515224106174-1639134728959.png",alt:"image-20200515224106174"}})])]),s._v(" "),a("li",[a("p",[s._v("在启动一个容器测试,发现又多了一对网卡")]),s._v(" "),a("ol",[a("li")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515224115938-1639134735201.png",alt:"image-20200515224115938"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#我们发这个容器带来的网卡 都是对对的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#evth-pair 就是一堆的虚拟设备接口，他们都是成对出现的，一段连着协议，一段彼此相连")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#正因为这个特性 veth-pair充当一个桥梁，连接各种虚拟网络设备的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#OpenStac，Docker容器之间的连接，OVS的连接，都是使用veth-pair连接")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("我们来测试 tomcat01和tomcat02是否可以ping通")])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#容器之间是可以ping通的")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515224956788-1639134739336.png",alt:"image-20200515224956788"}})]),s._v(" "),a("p",[s._v("结论：tomcat01和tomcat02是公用的一个路由器 docker0")]),s._v(" "),a("p",[s._v("所有的容器不指定网络的情况下，都是docker0路由的，docker会给我们的容器分配一个默认的可用ip")]),s._v(" "),a("p",[s._v("255.255.0.1/16 域")]),s._v(" "),a("blockquote",[a("p",[s._v("小结")])]),s._v(" "),a("p",[s._v("Docker使用的是Linux的桥接")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515225449704-1639134743163.png",alt:"image-20200515225449704"}})]),s._v(" "),a("p",[s._v("Docker 中的所有的网络接口都是虚拟的，虚拟的转发效率高！")]),s._v(" "),a("p",[s._v("只要容器删除，对应的网桥对就没了！")]),s._v(" "),a("h3",{attrs:{id:"link"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#link"}},[s._v("#")]),s._v(" --link")]),s._v(" "),a("blockquote",[a("p",[s._v("思考一个场景，我们i安歇了一个微服务，database url=ip: ,项目不重启，数据库ip换掉了，我们希望可以处理这个问题，可以通过名字来进行访问容器？")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" tomcat01 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" tomcat02\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这样不能ping 通")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#新建容器tomcat --link 来连接tomcat02")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tamcat03 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--link")]),s._v(" tomcat02 tomcat\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#tomcat03可以ping 通 tomcat02，但是tomcat02不能ping 通 tomcat03")]),s._v("\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("探究:docker network inspect {id}")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("hosts\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" tomcat03 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/hosts\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--link")]),s._v(" 就是再host2配置中增加了 tomcat02 的映射\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 真实开发已经不推荐使用了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#自定义网络！不适应docker0！")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker0问题:不支持容器名连接访问")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"自定义网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义网络"}},[s._v("#")]),s._v(" 自定义网络")]),s._v(" "),a("blockquote",[a("p",[s._v("查看所有的docker网络 docker network ls")])]),s._v(" "),a("p",[a("strong",[s._v("网络模式")])]),s._v(" "),a("p",[s._v("bridge：桥接 docker（默认）")]),s._v(" "),a("p",[s._v("none：不配置网络")]),s._v(" "),a("p",[s._v("host：和宿主机共享网络")]),s._v(" "),a("p",[s._v("container：容器网络连通（用的少，局限很大）")]),s._v(" "),a("p",[a("strong",[s._v("测试")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#我们直接启动的命令 默认 --net brighe 而这个就是我们的docker0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tomcat01 tomcat\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#自定义网络")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#--driver bridge")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#--subnet 192.168.0.0/16")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#--gateway 192.168.0.1 mynet")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--driver")]),s._v(" brighe "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--subnet")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.0/16 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--gateway")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.1 mynet\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tamcat-net-01 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--net")]),s._v(" mynet tomcat\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tamcat-net-02 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--net")]),s._v(" mynet tomcat\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" tomcat01 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" tomcat02 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不用--link也可以ping通")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("推荐我们平时自定义网络")]),s._v(" "),a("p",[s._v("好处：")]),s._v(" "),a("p",[s._v("redis-不同的集群使用不同的网络，保证集群式安全和健康的")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network connect "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#自定义网络连接docker0的tomcat01")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network connect mynet tomcat01 \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#直接将tomcat01放到了mynet的网络下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#一个容器两个地址")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#阿里云服务器 公有IP 私有IP")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("结论：假设要跨网络操作别人，就需要docker network connect 联通！")]),s._v(" "),a("h3",{attrs:{id:"实战-部署redis集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实战-部署redis集群"}},[s._v("#")]),s._v(" 实战：部署Redis集群")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515233802758-1639134747480.png",alt:"image-20200515233802758"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515233610477-1639134755217.png",alt:"image-20200515233610477"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515233958729-1639134797899.png",alt:"image-20200515233958729"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200515234053268-1639134808918.png",alt:"image-20200515234053268"}}),a("img",{attrs:{src:"D:%5CDesk%5CDocument%5C%E7%AC%94%E8%AE%B0%5CDocker%5Cdocker.assets%5Cimage-20200515234215291.png",alt:"image-20200515234215291"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建网卡")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create redis "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--subnet")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.0/16\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#通过脚本创建六个redis配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("port")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\n\n\n\n\nredis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--cluster")]),s._v(" create "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.11:6379 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.12:6379 \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.13:6379 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.14:6379 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.15:6379 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.16:6379 --cluster-replicas "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("docker搭建redis集群完成")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("redis-cli "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#连接集群")]),s._v("\ncluster info "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#打印信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" a b\nget a\ncluster nodes \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"springboot微服务打包docker镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#springboot微服务打包docker镜像"}},[s._v("#")]),s._v(" SpringBoot微服务打包Docker镜像")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200516000259099-1639134814063.png",alt:"image-20200516000259099"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/yong-forever/image_store/raw/master/utools/image-20200516000338133-1639134818113.png",alt:"image-20200516000338133"}})]),s._v(" "),a("h2",{attrs:{id:"企业实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#企业实战"}},[s._v("#")]),s._v(" 企业实战")]),s._v(" "),a("h2",{attrs:{id:"docker-compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" Docker Compose")]),s._v(" "),a("h2",{attrs:{id:"docker-swarm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-swarm"}},[s._v("#")]),s._v(" Docker Swarm")]),s._v(" "),a("h2",{attrs:{id:"docker-stack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-stack"}},[s._v("#")]),s._v(" Docker Stack")]),s._v(" "),a("h2",{attrs:{id:"docker-secret"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-secret"}},[s._v("#")]),s._v(" Docker Secret")]),s._v(" "),a("h2",{attrs:{id:"docker-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-config"}},[s._v("#")]),s._v(" Docker Config")]),s._v(" "),a("h2",{attrs:{id:"ci-cd-jenkins-流水线"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ci-cd-jenkins-流水线"}},[s._v("#")]),s._v(" CI/CD Jenkins 流水线")])])}),[],!1,null,null,null);a.default=n.exports}}]);